<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â∞èÁªø - Êô∫ÊÖßÂÜúÂú∫Âä©Êâã</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Êô∫ÊÖßÂÜúÂú∫AIÂä©ÊâãÔºåÊèê‰æõ‰∏ì‰∏öÁöÑÂÜú‰∏öÂí®ËØ¢ÂíåÊåáÂØºÊúçÂä°">
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Â∞èÁªøÂä©Êâã">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/logo.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://webapi.amap.com/loader.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            font-family: 'Inter', sans-serif;
            box-sizing: border-box;
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #e0f2e9 0%, #c8e6c9 100%) !important;
        }

        .gradient-bg .text-white, .gradient-bg .text-white\/70 {
            color: #222 !important;
        }

        .gradient-bg .glass-effect {
            background: rgba(255,255,255,0.7) !important;
            border: 1px solid rgba(0,0,0,0.08) !important;
        }

        .bg-pattern {
            background-color: #f0f8f0;
            background-image: linear-gradient(rgba(144, 238, 144, 0.1) 1px, transparent 1px),
                            linear-gradient(90deg, rgba(144, 238, 144, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .chat-bubble {
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        #avatar-container {
            background: radial-gradient(circle, rgba(34, 197, 94, 0.2) 0%, rgba(240, 248, 240, 0.1) 100%);
            position: relative;
        }

        .nav-button {
            transition: all 0.3s ease;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.3);
        }

        .modal {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.7);
        }

        .service-card {
            transition: all 0.3s ease;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(34, 197, 94, 0.3);
        }

        #map-container {
            border-radius: 12px;
            overflow: hidden;
        }

        .floating-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .voice-wave {
            width: 4px;
            height: 20px;
            background: #22c55e;
            margin: 0 2px;
            border-radius: 2px;
            animation: wave 1s infinite ease-in-out;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }

        @keyframes wave {
            0%, 100% { height: 10px; }
            50% { height: 30px; }
        }

        .nav-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px;
            min-width: 200px;
            z-index: 9999;
        }

        .nav-dropdown a {
            display: block;
            padding: 8px 12px;
            color: white;
            text-decoration: none;
            transition: background 0.2s;
        }

        .nav-dropdown a:hover {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        .nav-item:hover .nav-dropdown {
            display: block;
        }

        .context-menu {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px;
            z-index: 1000;
            display: none;
        }

        .context-menu a {
            display: block;
            padding: 8px 12px;
            color: white;
            text-decoration: none;
        }

        .context-menu a:hover {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        .divider {
            width: 5px;
            background: #ddd;
            cursor: ew-resize;
            position: relative;
            z-index: 10;
        }

        .emoji {
            font-size: 1.5em;
            margin-right: 5px;
        }

        .chat-panel {
            transition: width 0.2s ease;
        }

        .vertical-layout .main-container {
            flex-direction: column;
        }

        .vertical-layout .chat-panel {
            width: 100%;
            height: 40%;
        }

        .compact-layout .chat-panel {
            width: 100%;
            position: fixed;
            bottom: 0;
            height: 50%;
            z-index: 10;
        }

        .compact-layout #avatar-container {
            height: 100vh;
        }

        .dark-theme {
            background: linear-gradient(135deg, #1e3a8a 0%, #4c1d95 100%);
        }

        .light-theme {
            background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
        }

        .light-theme .glass-effect {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .light-theme .text-white {
            color: #1f2937;
        }

        .light-theme .text-white/70 {
            color: #4b5563;
        }

        .light-theme .bg-gradient-to-br {
            background: linear-gradient(to bottom right, #60a5fa, #a78bfa);
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            .chat-panel {
                width: 100% !important;
                height: 40%;
            }
            .divider {
                display: none;
            }
            .modal {
                margin: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen gradient-bg overflow-hidden">
    <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
    <nav class="glass-effect border-b border-white/20 px-6 py-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="w-10 h-10 bg-gradient-to-br from-green-400 to-emerald-500 rounded-lg flex items-center justify-center">
                    <span class="text-white font-bold text-lg">üå±</span>
                </div>
                <div>
                    <h1 class="text-white font-semibold text-xl" id="app-title">Â∞èÁªø - Êô∫ÊÖßÂÜúÂú∫Âä©Êâã</h1>
                    <p class="text-white/70 text-sm">ÂÜú‰∏öÂí®ËØ¢ ‚Ä¢ ÈÇÆ‰ª∂ÈÄöÁü• ‚Ä¢ Â§©Ê∞îÊü•ËØ¢</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div class="nav-item relative">
                    <button id="location-btn" class="nav-button glass-effect px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-200 flex items-center gap-2">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
                        </svg>
                        <span id="location-text">Ëé∑Âèñ‰ΩçÁΩÆ</span>
                    </button>
                    <div class="nav-dropdown">
                        <a href="#" data-action="current-location">Ëé∑ÂèñÂΩìÂâç‰ΩçÁΩÆ</a>
                        <a href="#" data-action="search-poi">ÊêúÁ¥¢ÈôÑËøëPOI</a>
                        <a href="#" data-action="route-plan">Ë∑ØÁ∫øËßÑÂàí</a>
                    </div>
                </div>
                <div class="nav-item relative">
                    <button id="services-btn" class="nav-button bg-gradient-to-r from-green-500 to-emerald-500 text-white px-4 py-2 rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all duration-200">
                        ÊúçÂä°‰∏≠ÂøÉ
                    </button>
                    <div class="nav-dropdown">
                        <a href="#" data-service="ai-chat">ÂÜú‰∏öÊô∫ËÉΩÂí®ËØ¢</a>
                        <a href="#" data-service="navigation">Âú∞ÂõæÂØºËà™</a>
                        <a href="#" data-service="email">ÈÇÆ‰ª∂ÊúçÂä°</a>
                        <a href="#" data-service="weather">Â§©Ê∞îÊü•ËØ¢</a>
                        <a href="#" data-service="settings">Áî®Êà∑ËÆæÁΩÆ</a>
                        <a href="#" data-service="system-status">Á≥ªÁªüÁä∂ÊÄÅ</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ‰∏ªÂÆπÂô® -->
    <div class="main-container flex h-[calc(100vh-80px)]">
        <!-- Â∑¶‰æßÔºö3DÊï∞Â≠ó‰∫∫Â±ïÁ§∫Âå∫ -->
        <div class="flex-1 relative" id="avatar-container">
            <canvas id="three-canvas" class="w-full h-full"></canvas>
            <!-- Êï∞Â≠ó‰∫∫Áä∂ÊÄÅÈù¢Êùø -->
            <div class="absolute top-6 left-6 glass-effect rounded-xl p-4 text-white">
                <div class="flex items-center gap-3">
                    <div id="status-indicator" class="w-3 h-3 bg-green-400 rounded-full pulse-animation"></div>
                    <span id="status-text" class="text-sm font-medium"><span class="emoji">üòê</span>Áä∂ÊÄÅ: ÂæÖÊú∫</span>
                </div>
                <div class="mt-2 text-xs opacity-75 space-y-1">
                    <div>ËØ≠Èü≥ËØÜÂà´: <span id="speech-status" class="text-green-400">ÂæÖÊú∫‰∏≠</span></div>
                    <div>‰ΩçÁΩÆÊúçÂä°: <span id="location-status" class="text-yellow-400">Êú™Ëé∑Âèñ</span></div>
                    <div>Âú®Á∫øÁî®Êà∑: <span class="text-blue-400" id="online-users">1,247</span></div>
                    <div>Â§©Ê∞î: <span id="weather-status" class="text-gray-400">Êú™Êü•ËØ¢</span></div>
                </div>
            </div>
            <!-- ÂäüËÉΩÊéßÂà∂Èù¢Êùø -->
            <div class="absolute bottom-6 left-6 flex flex-col gap-3">
                <button id="voice-btn" class="glass-effect w-16 h-16 rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-all duration-200 relative">
                    <svg id="mic-icon" class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z" clip-rule="evenodd"></path>
                    </svg>
                    <div id="voice-waves" class="absolute inset-0 rounded-full hidden flex items-center justify-center">
                        <div class="voice-wave"></div>
                        <div class="voice-wave"></div>
                        <div class="voice-wave"></div>
                        <div class="voice-wave"></div>
                    </div>
                </button>
                <button id="voice-pause-btn" class="glass-effect w-16 h-16 rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-all duration-200 hidden">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>
                </button>
                <button id="map-toggle" class="glass-effect w-16 h-16 rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-all duration-200">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 10.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z" clip-rule="evenodd"></path>
                    </svg>
                </button>
                <button id="avatar-controls" class="glass-effect w-16 h-16 rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-all duration-200">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <!-- Âú∞ÂõæÂÆπÂô® -->
            <div id="map-overlay" class="absolute inset-4 glass-effect rounded-xl hidden">
                <div class="p-4 border-b border-white/20 flex justify-between items-center">
                    <h3 class="text-white font-medium">Âú∞ÂõæÂØºËà™</h3>
                    <button id="close-map" class="text-white/70 hover:text-white">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
                <div id="map-container" class="w-full h-[calc(100%-60px)]"></div>
                <div class="p-4">
                    <input id="poi-search" type="text" placeholder="ÊêúÁ¥¢ÈôÑËøëÂú∞ÁÇπ..." class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50">
                    <div id="poi-results" class="mt-2 max-h-40 overflow-y-auto"></div>
                </div>
            </div>
            <!-- 3DÊ®°ÂûãÂè≥ÈîÆËèúÂçï -->
            <div id="context-menu" class="context-menu">
                <a href="#" data-action="wave">Êå•ÊâãÂä®Áîª</a>
                <a href="#" data-action="idle">ÂæÖÊú∫Âä®Áîª</a>
                <a href="#" data-action="dance">Ë∑≥ËàûÂä®Áîª</a>
                <a href="#" data-action="reset">ÈáçÁΩÆËßÜËßí</a>
            </div>
        </div>
        <!-- ÂàÜÈöîÊù° -->
        <div id="divider" class="divider"></div>
        <!-- Âè≥‰æßÔºöËÅäÂ§©ÁïåÈù¢ -->
        <div class="chat-panel glass-effect flex flex-col border-l border-white/20" id="chat-panel">
            <div class="p-6 border-b border-white/20">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center relative">
                        <span class="text-white font-bold text-lg">üå±</span>
                        <div class="absolute -top-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-white"></div>
                    </div>
                    <div>
                        <h2 class="text-white font-semibold text-lg" id="chat-header">Â∞èÁªø - Êô∫ÊÖßÂÜúÂú∫Âä©Êâã</h2>
                        <p class="text-white/70 text-sm">‰∏ì‰∏öÂÜú‰∏öÁü•ËØÜÔºåË¥¥ÂøÉÊúçÂä°</p>
                    </div>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-3 text-xs">
                    <div class="glass-effect rounded-lg p-2 text-center">
                        <div class="text-white/60">‰ªäÊó•ÂØπËØù</div>
                        <div class="text-white font-semibold" id="chat-count">0</div>
                    </div>
                    <div class="glass-effect rounded-lg p-2 text-center">
                        <div class="text-white/60">ÂìçÂ∫îÊó∂Èó¥</div>
                        <div class="text-green-400 font-semibold" id="response-time">0.8s</div>
                    </div>
                </div>
            </div>
            <div id="chat-messages" class="flex-1 p-4 overflow-y-auto space-y-4">
                <div class="chat-bubble">
                    <div class="flex items-start gap-3">
                        <div class="w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
                            <span class="text-white text-xs font-bold">üå±</span>
                        </div>
                        <div class="glass-effect rounded-lg p-3 max-w-xs">
                            <p class="text-white text-sm">ÊÇ®Â•ΩÔºÅÊàëÊòØÊÇ®ÁöÑÊô∫ÊÖßÂÜúÂú∫Âä©ÊâãÂ∞èÁªøÔºÅüå±<br>ÂèØ‰ª•Â∏ÆÊÇ®Ôºö<br>üåæ ÂÜú‰∏öÂí®ËØ¢<br>üó∫Ô∏è Âú∞ÂõæÂØºËà™<br>üìß ÈÇÆ‰ª∂ÈÄöÁü•<br>üå§Ô∏è Â§©Ê∞îÊü•ËØ¢<br>Êúâ‰ªÄ‰πàÂÜú‰∏öÈóÆÈ¢òÊàëÂèØ‰ª•Â∏ÆÊÇ®Ëß£Á≠îÂêóÔºü</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="p-4 border-t border-white/20">
                <div class="flex gap-3">
                    <input
                        id="message-input"
                        type="text"
                        placeholder="ÂíåÂ∞èÁªøËÅäËÅäÂÜú‰∏öÈóÆÈ¢òÂêß~"
                        class="flex-1 bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/50 focus:outline-none focus:border-white/40 transition-colors"
                    >
                    <button id="send-btn" class="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-3 rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all duration-200 font-medium">
                        ÂèëÈÄÅ
                    </button>
                </div>
                <div class="mt-3 flex gap-2 flex-wrap">
                    <button class="quick-action bg-white/10 text-white text-xs px-3 py-2 rounded-full hover:bg-white/20 transition-colors" data-action="navigation">üìç ÂØºËà™ÊúçÂä°</button>
                    <button id="refresh-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">üîÅ Âà∑Êñ∞Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ</button>
                    <button class="quick-action bg-white/10 text-white text-xs px-3 py-2 rounded-full hover:bg-white/20 transition-colors" data-action="settings">‚öôÔ∏è ËÆæÁΩÆ</button>
                    <button class="quick-action bg-white/10 text-white text-xs px-3 py-2 rounded-full hover:bg-white/20 transition-colors" data-action="history">üìú ÂéÜÂè≤ËÆ∞ÂΩï</button>
                    <button id="send-suggestion" class="quick-action bg-blue-500 text-white text-xs px-3 py-2 rounded-full hover:bg-blue-600 transition-colors">üí° ÂèëÈÄÅÂª∫ËÆÆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÊúçÂä°‰∏≠ÂøÉÊ®°ÊÄÅÊ°Ü -->
    <div id="services-modal" class="fixed inset-0 modal hidden flex items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 max-w-4xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-white text-2xl font-bold">ÊúçÂä°‰∏≠ÂøÉ</h2>
                <button id="close-services" class="text-white/70 hover:text-white">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="service-card glass-effect rounded-xl p-6 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="text-white text-lg font-semibold mb-2">AIÊô∫ËÉΩÂØπËØù</h3>
                    <p class="text-white/70 text-sm mb-4">Âü∫‰∫éDeepSeek AIÁöÑÊô∫ËÉΩÈóÆÁ≠îÁ≥ªÁªüÔºåÊîØÊåÅËá™ÁÑ∂ËØ≠Ë®ÄÂØπËØù</p>
                    <div class="text-xs text-green-400 mb-2">‚úÖ Â∑≤ÈõÜÊàê DeepSeek API</div>
                    <button class="service-btn w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition-colors" data-service="ai-chat">
                        ÂºÄÂßãÂØπËØù
                    </button>
                </div>
                <div class="service-card glass-effect rounded-xl p-6 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="text-white text-lg font-semibold mb-2">Âú∞ÂõæÂØºËà™</h3>
                    <p class="text-white/70 text-sm mb-4">È´òÂæ∑Âú∞ÂõæÈõÜÊàêÔºåÊèê‰æõÁ≤æÂáÜÂÆö‰ΩçÂíåË∑ØÁ∫øËßÑÂàíÊúçÂä°</p>
                    <div class="text-xs text-green-400 mb-2">‚úÖ Â∑≤ÈõÜÊàê È´òÂæ∑Âú∞Âõæ API</div>
                    <button class="service-btn w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg transition-colors" data-service="navigation">
                        ÊâìÂºÄÂú∞Âõæ
                    </button>
                </div>
                <div class="service-card glass-effect rounded-xl p-6 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                            <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                        </svg>
                    </div>
                    <h3 class="text-white text-lg font-semibold mb-2">ÂèëÈÄÅÂª∫ËÆÆ</h3>
                    <p class="text-white/70 text-sm mb-4">Ê¨¢Ëøé‰∏∫Â∞èÁªøÊèêÂá∫ÂÆùË¥µÂª∫ËÆÆÔºåÊÇ®ÁöÑÂª∫ËÆÆÂ∞ÜÂèëÈÄÅÂà∞ÂºÄÂèëËÄÖÈÇÆÁÆ±</p>
                    <div class="text-xs text-green-400 mb-2">‚úÖ ÂèëÈÄÅÂà∞ 2138277532@qq.com</div>
                    <button id="service-suggestion-btn" class="service-btn w-full bg-indigo-500 hover:bg-indigo-600 text-white py-2 rounded-lg transition-colors">
                        ÂèëÈÄÅÂª∫ËÆÆ
                    </button>
                </div>
                <div class="service-card glass-effect rounded-xl p-6 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2z"></path>
                        </svg>
                    </div>
                    <h3 class="text-white text-lg font-semibold mb-2">Â§©Ê∞îÊü•ËØ¢</h3>
                    <p class="text-white/70 text-sm mb-4">ÂÆûÊó∂Â§©Ê∞î‰ø°ÊÅØÊü•ËØ¢ÔºåÂü∫‰∫éOpenWeatherMap API</p>
                    <div class="text-xs text-green-400 mb-2">‚úÖ Â∑≤ÈõÜÊàê OpenWeatherMap API</div>
                    <button class="service-btn w-full bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded-lg transition-colors" data-service="weather">
                        Êü•ËØ¢Â§©Ê∞î
                    </button>
                </div>
                <div class="service-card glass-effect rounded-xl p-6 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-gray-400 to-gray-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="text-white text-lg font-semibold mb-2">Áî®Êà∑ËÆæÁΩÆ</h3>
                    <p class="text-white/70 text-sm mb-4">Ëá™ÂÆö‰πâÈ°µÈù¢Â∏ÉÂ±Ä„ÄÅ‰∏ªÈ¢òÂíå3DÊ®°ÂûãËÆæÁΩÆ</p>
                    <div class="text-xs text-green-400 mb-2">‚úÖ Êú¨Âú∞ÈÖçÁΩÆ</div>
                    <button class="service-btn w-full bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors" data-service="settings">
                        ÊâìÂºÄËÆæÁΩÆ
                    </button>
                </div>
                <div class="service-card glass-effect rounded-xl p-6 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-gray-400 to-gray-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="text-white text-lg font-semibold mb-2">Á≥ªÁªüÁä∂ÊÄÅ</h3>
                    <p class="text-white/70 text-sm mb-4">Êü•ÁúãÁ≥ªÁªüËøêË°åÁä∂ÊÄÅÂíåAPIÊúçÂä°ÂÅ•Â∫∑Â∫¶</p>
                    <div class="text-xs text-green-400 mb-2">‚úÖ Á≥ªÁªüÊ≠£Â∏∏ËøêË°å</div>
                    <button class="service-btn w-full bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors" data-service="system-status">
                        Á≥ªÁªüÁä∂ÊÄÅ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ËÆæÁΩÆÊ®°ÊÄÅÊ°Ü -->
    <div id="settings-modal" class="fixed inset-0 modal hidden flex items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 max-w-md w-full m-4">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-white text-2xl font-bold">Áî®Êà∑ËÆæÁΩÆ</h2>
                <button id="close-settings" class="text-white/70 hover:text-white">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="text-white text-sm">ËßíËâ≤ÂêçÁß∞</label>
                    <input id="role-name" type="text" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white" value="Â∞èËâæ">
                </div>
                <div>
                    <label class="text-white text-sm">3DÊ®°Âûã</label>
                    <select id="model-select" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white">
                        <option value="xiaoai">Â∞èËâæ</option>
                        <option value="xiaoming">Â∞èÊòé</option>
                        <option value="xiaohong">Â∞èÁ∫¢</option>
                    </select>
                </div>
                <div>
                    <label class="text-white text-sm">È°µÈù¢Â∏ÉÂ±Ä</label>
                    <select id="layout-select" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white">
                        <option value="horizontal">Ê∞¥Âπ≥Â∏ÉÂ±Ä</option>
                        <option value="vertical">ÂûÇÁõ¥Â∏ÉÂ±Ä</option>
                        <option value="compact">Á¥ßÂáëÂ∏ÉÂ±Ä</option>
                    </select>
                </div>
                <div>
                    <label class="text-white text-sm">‰∏ªÈ¢ò</label>
                    <select id="theme-select" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white">
                        <option value="gradient-bg">ÈªòËÆ§‰∏ªÈ¢ò</option>
                        <option value="dark-theme">Ê∑±Ëâ≤‰∏ªÈ¢ò</option>
                        <option value="light-theme">ÊµÖËâ≤‰∏ªÈ¢ò</option>
                    </select>
                </div>
                <div>
                    <label class="text-white text-sm">Âä®ÁîªÈÄüÂ∫¶</label>
                    <input id="animation-speed" type="range" min="0.5" max="2" step="0.1" value="1" class="w-full">
                </div>
                <div>
                    <label class="text-white text-sm">Èº†Ê†áË∑üÈöèËßÜÁ∫ø</label>
                    <input id="mouse-follow" type="checkbox" class="ml-2" checked>
                </div>
                <div>
                    <label class="text-white text-sm">ËØ≠Èü≥ÂèçÈ¶à</label>
                    <input id="tts-toggle" type="checkbox" class="ml-2">
                </div>
                <button id="save-settings" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition-colors">‰øùÂ≠òËÆæÁΩÆ</button>
            </div>
        </div>
    </div>

    <!-- ÂéÜÂè≤ËÆ∞ÂΩïÊ®°ÊÄÅÊ°Ü -->
    <div id="history-modal" class="fixed inset-0 modal hidden flex items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-white text-2xl font-bold">ÂéÜÂè≤ÂØπËØù</h2>
                <button id="close-history" class="text-white/70 hover:text-white">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div id="history-messages" class="space-y-4"></div>
            <div class="mt-4 flex flex-wrap gap-2">
                <button id="clear-history" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">Ê∏ÖÁ©∫ÂéÜÂè≤</button>
            </div>
        </div>
    </div>

    <!-- ÈÄöÁü•ÂÆπÂô® -->
    <div id="notification-container"></div>

    <!-- Âä†ËΩΩÊèêÁ§∫ -->
    <div id="loading" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="glass-effect rounded-xl p-8 text-center">
            <div class="typing-indicator justify-center mb-4">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
            <p class="text-white font-medium">Ê≠£Âú®ÂàùÂßãÂåñÂ∞èÁªøÁ≥ªÁªü...</p>
            <p class="text-white/70 text-sm mt-2">Âä†ËΩΩÊô∫ÊÖßÂÜúÂú∫Âä©Êâã‰∏≠...</p>
        </div>
    </div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáèÔºåÁî®‰∫é‰øùÂ≠òÊï∞ÊçÆÂ∫ìÂÜÖÂÆπ
        let databaseContent = "";

        // State Management
        const state = {
            shouldInjectDatabase: false,
            chatCount: 0,
            responseTime: 0.8,
            location: null,
            isVoiceActive: false,
            mapVisible: false,
            servicesModalVisible: false,
            settingsModalVisible: false,
            historyModalVisible: false,
            onlineUsers: 1247,
            speechRecognition: null,
            currentPosition: null,
            map: null,
            model: null,
            mixer: null,
            animations: {},
            currentState: 'Idle',
            animationSpeed: 1,
            ttsEnabled: false,
            layout: 'horizontal',
            theme: 'gradient-bg',
            chatHistory: [],
            roleName: 'Â∞èÁªø',
            currentModel: 'xiaoai',
            mouseFollow: true,
            mousePosition: { x: 0, y: 0 },
            // Êñ∞Â¢ûÁä∂ÊÄÅ
            currentExpression: 'neutral', // ÂΩìÂâçË°®ÊÉÖ
            currentEmote: null, // ÂΩìÂâçÂä®‰Ωú
            isSpeaking: false, // ÊòØÂê¶Ê≠£Âú®ËØ¥ËØù
            availableExpressions: ['angry', 'surprised', 'sad', 'happy', 'neutral'], // ÂèØÁî®Ë°®ÊÉÖ
            availableStates: ['idle', 'walking', 'running', 'sitting', 'standing'], // ÂèØÁî®Áä∂ÊÄÅ
            availableEmotes: ['yes', 'no', 'punch', 'thumbsup'] // ÂèØÁî®Âä®‰Ωú
        };

        // Model Configurations
        const models = {
            xiaoai: {
                url: 'https://threejs.org/examples/models/gltf/RobotExpressive/RobotExpressive.glb', // Replace with actual chibi model URL
                name: 'Â∞èËâæ',
                scale: 0.5
            },
            xiaoming: {
                url: 'https://threejs.org/examples/models/gltf/Horse.glb', // Replace with actual chibi model URL
                name: 'Â∞èÊòé',
                scale: 0.5
            },
            xiaohong: {
                url: 'https://threejs.org/examples/models/gltf/Parrot.glb', // Replace with actual chibi model URL
                name: 'Â∞èÁ∫¢',
                scale: 0.5
            }
        };

        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `floating-notification glass-effect rounded-lg p-4 text-white ${type === 'error' ? 'bg-red-500/80' : 'bg-blue-500/80'}`;
            notification.innerHTML = message;
            document.getElementById('notification-container').appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.5s ease-in';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
            playSound('notification');
        }

        function updateStatusPanel() {
            document.getElementById('chat-count').textContent = state.chatCount;
            document.getElementById('response-time').textContent = `${state.responseTime.toFixed(1)}s`;
            document.getElementById('online-users').textContent = state.onlineUsers;
            document.getElementById('location-status').textContent = state.location ? 'Â∑≤Ëé∑Âèñ' : 'Êú™Ëé∑Âèñ';
            document.getElementById('speech-status').textContent = state.isVoiceActive ? 'ËØÜÂà´‰∏≠' : 'ÂæÖÊú∫‰∏≠';

            // Êõ¥Êñ∞Ë°®ÊÉÖÁä∂ÊÄÅ
            const emojis = {
                'neutral': 'üòê',
                'angry': 'üò†',
                'surprised': 'üò≤',
                'sad': 'üò¢',
                'happy': 'üòä',
                'Idle': 'üòê',
                'Thinking': 'ü§î',
                'Replying': 'üí¨'
            };

            let statusText = state.currentState;
            if (state.currentEmote) {
                statusText = `${state.currentEmote} Âä®‰Ωú`;
            }

            const emoji = emojis[state.currentExpression] || emojis[state.currentState] || 'üòê';
            document.getElementById('status-text').innerHTML = `<span class="emoji">${emoji}</span>Áä∂ÊÄÅ: ${statusText}`;
        }

        function playSound(type) {
            const sounds = {
                message: new Audio('/22.mp3'), // Replace with actual sound URL
                notification: new Audio('/11.mp3') // Replace with actual sound URL
            };
            if (sounds[type]) {
                sounds[type].play().catch(() => console.log('Sound playback failed'));
            }
        }

        // Three.js 3D Avatar Setup
        function initThreeJS() {
            const canvas = document.getElementById('three-canvas');
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas, alpha: true });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);

            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.4);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);

            // Orbit Controls
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 1;
            controls.maxDistance = 5;

            // Load Model
            function loadModel(modelKey) {
                if (state.model) {
                    scene.remove(state.model);
                    state.model = null;
                    state.mixer = null;
                    state.animations = {};
                }
                const loader = new THREE.GLTFLoader();
                loader.load(
                    models[modelKey].url,
                    (gltf) => {
                        state.model = gltf.scene;
                        state.model.scale.set(0.3, 0.3, 0.3);
                        state.model.position.set(0, -1, 0);
                        scene.add(state.model);

                        // Initialize Animations
                        state.mixer = new THREE.AnimationMixer(state.model);

                        // Â§ÑÁêÜÊâÄÊúâÂä®Áîª
                        gltf.animations.forEach((clip) => {
                            state.animations[clip.name] = state.mixer.clipAction(clip);
                        });

                        // ËÆæÁΩÆÈªòËÆ§Áä∂ÊÄÅ
                        if (state.animations['Idle']) {
                            state.animations['Idle'].play();
                        }

                        // ÂàùÂßãÂåñË°®ÊÉÖ
                        if (modelKey === 'xiaoai') {
                            // ÂàùÂßãÂåñË°®ÊÉÖÂΩ¢ÊÄÅÁõÆÊ†á
                            state.model.traverse((node) => {
                                if (node.isSkinnedMesh) {
                                    node.morphTargetInfluences = node.morphTargetInfluences || [];
                                }
                            });
                            setExpression('neutral');
                        }
                        state.currentModel = modelKey;
                        updateRoleDisplay();
                        showNotification(`Â∑≤ÂàáÊç¢Âà∞${models[modelKey].name}`);
                    },
                    undefined,
                    (error) => {
                        console.error('Model Loading Error:', error);
                        showNotification('Êó†Ê≥ïÂä†ËΩΩ3DÊ®°Âûã', 'error');
                        // Fallback to sphere
                        const geometry = new THREE.SphereGeometry(0.3, 32, 32);
                        const material = new THREE.MeshBasicMaterial({ color: 0xff6f61, wireframe: true });
                        state.model = new THREE.Mesh(geometry, material);
                        scene.add(state.model);
                    }
                );
            }

            loadModel(state.currentModel);
            camera.position.set(0, 0.5, 2);

            // Mouse Following
            let headBone = null;
            function updateHeadRotation() {
                if (state.model && state.mouseFollow) {
                    if (!headBone) {
                        state.model.traverse((child) => {
                            if (child.isBone && child.name.toLowerCase().includes('head')) {
                                headBone = child;
                            }
                        });
                    }
                    if (headBone) {
                        const mouseX = (state.mousePosition.x / window.innerWidth) * 2 - 1;
                        const mouseY = -(state.mousePosition.y / window.innerHeight) * 2 + 1;
                        headBone.rotation.y = mouseX * 0.5;
                        headBone.rotation.x = mouseY * 0.3;
                    }
                }
            }

            // Animation Loop
            const clock = new THREE.Clock();
            function animate() {
                requestAnimationFrame(animate);
                const delta = clock.getDelta();
                if (state.mixer) {
                    state.mixer.update(delta * state.animationSpeed);
                }
                updateHeadRotation();
                controls.update();
                renderer.render(scene, camera);
            }
            animate();

            // Handle Window Resize
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            });

            // Mouse Movement
            document.addEventListener('mousemove', (e) => {
                state.mousePosition.x = e.clientX;
                state.mousePosition.y = e.clientY;
            });

            // Context Menu
            const contextMenu = document.getElementById('context-menu');
            canvas.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                contextMenu.style.display = 'block';
                contextMenu.style.left = `${e.clientX}px`;
                contextMenu.style.top = `${e.clientY}px`;
            });

            document.addEventListener('click', () => {
                contextMenu.style.display = 'none';
            });

            return { loadModel };
        }

        // 3D Model Interactions
        function playAnimation(name) {
            if (state.animations[name]) {
                // Â¶ÇÊûúÊòØË°®ÊÉÖÂä®ÁîªÔºå‰∏çÂÅúÊ≠¢ÂΩìÂâçÂä®‰Ωú
                const isEmote = state.availableEmotes.includes(name.toLowerCase());
                const isExpression = state.availableExpressions.includes(name.toLowerCase());

                if (!isEmote && !isExpression) {
                    // Â¶ÇÊûúÊòØÁä∂ÊÄÅÂä®ÁîªÔºåÂÅúÊ≠¢ÊâÄÊúâÂÖ∂‰ªñÁä∂ÊÄÅÂä®Áîª
                    Object.keys(state.animations).forEach(key => {
                        if (!state.availableEmotes.includes(key.toLowerCase()) &&
                            !state.availableExpressions.includes(key.toLowerCase())) {
                            state.animations[key].stop();
                        }
                    });
                }

                // Êí≠ÊîæÊñ∞Âä®Áîª
                if (isEmote) {
                    // Âä®‰ΩúÊòØ‰∏ÄÊ¨°ÊÄßÁöÑÔºåÊí≠ÊîæÂêéÂõûÂà∞‰πãÂâçÁöÑÁä∂ÊÄÅ
                    const action = state.animations[name];
                    action.setLoop(THREE.LoopOnce);
                    action.clampWhenFinished = true;
                    action.reset().play();
                    state.currentEmote = name;

                    // Âä®‰ΩúÂÆåÊàêÂêéÊÅ¢Â§çÂà∞‰πãÂâçÁöÑÁä∂ÊÄÅ
                    setTimeout(() => {
                        state.currentEmote = null;
                        if (state.animations[state.currentState]) {
                            state.animations[state.currentState].reset().play();
                        }
                    }, action.getClip().duration * 1000 / state.animationSpeed);
                } else {
                    state.animations[name].reset().play();
                    if (!isExpression) {
                        state.currentState = name;
                    }
                }

                showNotification(`Êí≠Êîæ${name}Âä®Áîª`);
                updateStatusPanel();
            } else {
                showNotification(`Âä®Áîª${name}‰∏çÂèØÁî®`, 'error');
            }
        }

        // ËÆæÁΩÆË°®ÊÉÖ
        function setExpression(expression) {
            if (!state.availableExpressions.includes(expression)) return;

            // ÈáçÁΩÆÊâÄÊúâË°®ÊÉÖ
            state.model.traverse((node) => {
                if (node.isSkinnedMesh && node.morphTargetInfluences) {
                    for (let i = 0; i < node.morphTargetInfluences.length; i++) {
                        node.morphTargetInfluences[i] = 0;
                    }
                }
            });

            // ËÆæÁΩÆÊñ∞Ë°®ÊÉÖ
            state.model.traverse((node) => {
                if (node.isSkinnedMesh && node.morphTargetDictionary) {
                    const morphTargetIndex = node.morphTargetDictionary[expression];
                    if (morphTargetIndex !== undefined) {
                        node.morphTargetInfluences[morphTargetIndex] = 1;
                    }
                }
            });

            state.currentExpression = expression;
            updateStatusPanel();
        }

        function resetCamera() {
            const canvas = document.getElementById('three-canvas');
            const camera = canvas.getContext('webgl').getParameter(canvas.getContext('webgl').CURRENT_PROGRAM).camera || { position: { set: () => {} } };
            camera.position.set(0, 0.5, 2);
            showNotification('ËßÜËßíÂ∑≤ÈáçÁΩÆ');
        }

        function setState(stateName) {
            state.currentState = stateName;

            // Áä∂ÊÄÅ‰∏éÂä®ÁîªÂíåË°®ÊÉÖÁöÑÊò†Â∞Ñ - Ê†πÊçÆÁî®Êà∑ÈúÄÊ±ÇË∞ÉÊï¥
            const stateAnimations = {
                'Thinking': 'Running',     // ÊÄùËÄÉÊó∂ËøõÂÖ•Â•îË∑ëÁä∂ÊÄÅ
                'UserInput': 'Dance',      // Áî®Êà∑ËæìÂÖ•Êó∂ËøõÂÖ•Ë∑≥ËàûÁä∂ÊÄÅ
                'Replying': 'Wave',        // ÂõûÂ§çÊó∂Êå•Êâã
                'Idle': 'Idle',           // ÂõûÂ§çÂÆåÊØïËøõÂÖ•ÂæÖÊú∫Áä∂ÊÄÅ
                'Happy': 'Dance',
                'Curious': 'Idle',
                'Sad': 'Idle'
            };

            const stateExpressions = {
                'Thinking': 'neutral',     // ÊÄùËÄÉÊó∂‰øùÊåÅ‰∏≠ÊÄßË°®ÊÉÖ
                'UserInput': 'happy',      // Áî®Êà∑ËæìÂÖ•Êó∂ÂºÄÂøÉË°®ÊÉÖ
                'Replying': 'happy',       // ÂõûÂ§çÊó∂ÂºÄÂøÉË°®ÊÉÖ
                'Idle': 'neutral',        // ÂæÖÊú∫Êó∂‰∏≠ÊÄßË°®ÊÉÖ
                'Happy': 'happy',
                'Curious': 'surprised',
                'Sad': 'sad'
            };

            // ËÆæÁΩÆÂä®Áîª
            if (stateAnimations[stateName] && state.animations[stateAnimations[stateName]]) {
                playAnimation(stateAnimations[stateName]);
            }

            // ËÆæÁΩÆË°®ÊÉÖ
            if (stateExpressions[stateName]) {
                setExpression(stateExpressions[stateName]);
            }

            updateStatusPanel();
        }

        // Highmaps API Integration
        function initMap() {
            if (!window.AMap) {
                showNotification('È´òÂæ∑Âú∞ÂõæAPIÊú™Âä†ËΩΩ', 'error');
                return;
            }
            state.map = new AMap.Map('map-container', {
                zoom: 14,
                center: [116.397428, 39.90923],
                viewMode: '3D',
                pitch: 45,
                mapStyle: 'amap://styles/light'
            });
            state.map.plugin(['AMap.ToolBar', 'AMap.Scale'], function() {
                state.map.addControl(new AMap.ToolBar());
                state.map.addControl(new AMap.Scale());
            });
        }

        function getCurrentLocation() {
            if (!window.AMap || !state.map) {
                showNotification('Âú∞ÂõæÂ∞öÊú™Âä†ËΩΩÂÆåÊàêÔºåËØ∑Á®çÂêéÂÜçËØï', 'error');
                return;
            }

            window.AMap.plugin('AMap.Geolocation', () => {
                const geolocation = new window.AMap.Geolocation({
                    enableHighAccuracy: true,
                    timeout: 10000,
                    buttonPosition: 'RB',
                    buttonOffset: new window.AMap.Pixel(10, 20)
                });
                state.map.addControl(geolocation);
                geolocation.getCurrentPosition((status, result) => {
                    if (status === 'complete') {
                        state.currentPosition = result.position;
                        state.map.setCenter(state.currentPosition);
                        document.getElementById('location-text').textContent = 'ÂΩìÂâç‰ΩçÁΩÆ';
                        state.location = result.formattedAddress;
                        updateStatusPanel();
                        showNotification('‰ΩçÁΩÆËé∑ÂèñÊàêÂäüÔºö' + state.location);
                    } else {
                        showNotification('Êó†Ê≥ïËé∑Âèñ‰ΩçÁΩÆÔºåËØ∑Ê£ÄÊü•ÊùÉÈôê', 'error');
                    }
                });
            });
        }

        function searchPOI(keyword) {
            if (!window.AMap || !state.map) {
                showNotification('Âú∞ÂõæÂ∞öÊú™Âä†ËΩΩÂÆåÊàêÔºåËØ∑Á®çÂêéÂÜçËØï', 'error');
                return;
            }

            window.AMap.plugin('AMap.PlaceSearch', () => {
                const placeSearch = new window.AMap.PlaceSearch({
                    pageSize: 10,
                    pageIndex: 1,
                    city: 'ÂÖ®ÂõΩ',
                    map: state.map
                });
                placeSearch.search(keyword, (status, result) => {
                    if (status === 'complete' && result.poiList) {
                        const poiResults = document.getElementById('poi-results');
                        poiResults.innerHTML = '';
                        result.poiList.pois.forEach(poi => {
                            const div = document.createElement('div');
                            div.className = 'glass-effect rounded-lg p-2 mb-2 cursor-pointer';
                            div.innerHTML = `<p class="text-white text-sm">${poi.name}</p><p class="text-white/70 text-xs">${poi.address}</p>`;
                            div.onclick = () => {
                                state.map.setCenter(poi.location);
                                new window.AMap.Marker({
                                    map: state.map,
                                    position: poi.location,
                                    title: poi.name
                                });
                            };
                            poiResults.appendChild(div);
                        });
                    } else {
                        showNotification('Êú™ÊâæÂà∞Áõ∏ÂÖ≥Âú∞ÁÇπ', 'error');
                    }
                });
            });
        }

        function planRoute(destination) {
            if (!window.AMap || !state.map) {
                showNotification('Âú∞ÂõæÂ∞öÊú™Âä†ËΩΩÂÆåÊàêÔºåËØ∑Á®çÂêéÂÜçËØï', 'error');
                return;
            }

            window.AMap.plugin(['AMap.Driving'], () => {
                const driving = new window.AMap.Driving({
                    map: state.map,
                    policy: window.AMap.DrivingPolicy.LEAST_TIME
                });
                driving.search(state.currentPosition, destination, (status, result) => {
                    if (status === 'complete') {
                        showNotification('Ë∑ØÁ∫øËßÑÂàíÊàêÂäü');
                    } else {
                        showNotification('Ë∑ØÁ∫øËßÑÂàíÂ§±Ë¥•', 'error');
                    }
                });
            });
        }

        // ÂÜúÂú∫È¢ÑËÆæ‰ø°ÊÅØÂ∫ì
        const farmKnowledgeBase = {
            // ‰ΩúÁâ©ÁßçÊ§çÁõ∏ÂÖ≥
            crops: {
                'Ê∞¥Á®ª': 'Ê∞¥Á®ªÊòØÈáçË¶ÅÁöÑÁ≤ÆÈ£ü‰ΩúÁâ©ÔºåÈÄÇÂÆúÂú®Ê∏©ÊöñÊπøÊ∂¶ÁöÑÁéØÂ¢É‰∏≠ÁîüÈïøÔºåÈúÄË¶ÅÂÖÖË∂≥ÁöÑÊ∞¥ÂàÜÂíåÈò≥ÂÖâ„ÄÇ',
                'Â∞èÈ∫¶': 'Â∞èÈ∫¶ÊòØ‰∏ñÁïå‰∏âÂ§ßË∞∑Áâ©‰πã‰∏ÄÔºåÈÄÇÂ∫îÊÄßÂº∫ÔºåÂú®Ê∏©Â∏¶Âú∞Âå∫ÂπøÊ≥õÁßçÊ§ç„ÄÇ',
                'ÁéâÁ±≥': 'ÁéâÁ±≥ÊòØÈáçË¶ÅÁöÑÁ≤ÆÈ£üÂíåÈ•≤Êñô‰ΩúÁâ©ÔºåÂñúÊ∏©ÂñúÂÖâÔºåÂØπÂúüÂ£§Ë¶ÅÊ±Ç‰∏ç‰∏•Ê†º„ÄÇ',
                'Â§ßË±Ü': 'Â§ßË±ÜÊòØÈáçË¶ÅÁöÑÊ≤πÊñô‰ΩúÁâ©ÂíåËõãÁôΩË¥®Êù•Ê∫êÔºåÂÖ∑ÊúâÂõ∫Ê∞ÆËÉΩÂäõÔºåËÉΩÊîπËâØÂúüÂ£§„ÄÇ'
            },
            // ÂÜú‰∏öÊäÄÊúØÁõ∏ÂÖ≥
            techniques: {
                'ÊúâÊú∫ÂÜú‰∏ö': 'ÊúâÊú∫ÂÜú‰∏öÊòØ‰∏ÄÁßç‰∏ç‰ΩøÁî®ÂåñÂ≠¶ÂêàÊàêÂÜúËçØ„ÄÅÂåñËÇ•ÁöÑÂèØÊåÅÁª≠ÂÜú‰∏öÁîü‰∫ßÊñπÂºè„ÄÇ',
                'Á≤æÂáÜÂÜú‰∏ö': 'Á≤æÂáÜÂÜú‰∏öÂà©Áî®Áé∞‰ª£‰ø°ÊÅØÊäÄÊúØÔºåÂÆûÁé∞ÂÜú‰∏öÁîü‰∫ßÁöÑÁ≤æÁ°ÆÂåñÁÆ°ÁêÜ„ÄÇ',
                'Êô∫ÊÖßÂÜú‰∏ö': 'Êô∫ÊÖßÂÜú‰∏öÁªìÂêàÁâ©ËÅîÁΩë„ÄÅÂ§ßÊï∞ÊçÆ„ÄÅ‰∫∫Â∑•Êô∫ËÉΩÁ≠âÊäÄÊúØÔºåÊèêÈ´òÂÜú‰∏öÁîü‰∫ßÊïàÁéá„ÄÇ',
                'ËäÇÊ∞¥ÁÅåÊ∫â': 'ËäÇÊ∞¥ÁÅåÊ∫âÊäÄÊúØÂåÖÊã¨Êª¥ÁÅå„ÄÅÂñ∑ÁÅåÁ≠âÔºåËÉΩÊúâÊïàÊèêÈ´òÊ∞¥ËµÑÊ∫êÂà©Áî®ÊïàÁéá„ÄÇ'
            },
            // ÁóÖËô´ÂÆ≥Èò≤Ê≤ª
            pestControl: {
                'ÁîüÁâ©Èò≤Ê≤ª': 'Âà©Áî®Â§©ÊïåÊòÜËô´„ÄÅÂæÆÁîüÁâ©Á≠âÁîüÁâ©Âõ†Â≠êÈò≤Ê≤ªÂÜú‰∏öÂÆ≥Ëô´ÁöÑÊñπÊ≥ï„ÄÇ',
                'Áâ©ÁêÜÈò≤Ê≤ª': 'Âà©Áî®Áâ©ÁêÜÂõ†Â≠êÂ¶ÇÊ∏©Â∫¶„ÄÅÊπøÂ∫¶„ÄÅÂÖâÁÖßÁ≠âÈò≤Ê≤ªÁóÖËô´ÂÆ≥„ÄÇ',
                'ÂåñÂ≠¶Èò≤Ê≤ª': '‰ΩøÁî®ÂÜúËçØÈò≤Ê≤ªÁóÖËô´ÂÆ≥ÔºåÈúÄË¶ÅÁßëÂ≠¶ÂêàÁêÜ‰ΩøÁî®ÔºåÈÅøÂÖçÁéØÂ¢ÉÊ±°Êüì„ÄÇ'
            }
        };

        // ‰ø°ÊÅØÊ£ÄÁ¥¢ÂáΩÊï∞
        function searchFarmKnowledge(query) {
            const results = [];
            const searchTerms = query.toLowerCase();

            // ÊêúÁ¥¢‰ΩúÁâ©‰ø°ÊÅØ
            Object.entries(farmKnowledgeBase.crops).forEach(([crop, info]) => {
                if (searchTerms.includes(crop) || crop.includes(searchTerms)) {
                    results.push(`„Äê‰ΩúÁâ©Áü•ËØÜ„Äë${crop}Ôºö${info}`);
                }
            });

            // ÊêúÁ¥¢ÊäÄÊúØ‰ø°ÊÅØ
            Object.entries(farmKnowledgeBase.techniques).forEach(([tech, info]) => {
                if (searchTerms.includes(tech) || tech.includes(searchTerms)) {
                    results.push(`„ÄêÂÜú‰∏öÊäÄÊúØ„Äë${tech}Ôºö${info}`);
                }
            });

            // ÊêúÁ¥¢ÁóÖËô´ÂÆ≥Èò≤Ê≤ª‰ø°ÊÅØ
            Object.entries(farmKnowledgeBase.pestControl).forEach(([method, info]) => {
                if (searchTerms.includes(method) || method.includes(searchTerms)) {
                    results.push(`„ÄêÁóÖËô´ÂÆ≥Èò≤Ê≤ª„Äë${method}Ôºö${info}`);
                }
            });

            return results;
        }

        // DeepSeek API Integration
        async function sendToDeepSeek(message) {
            try {
                // È¶ñÂÖàÊ£ÄÁ¥¢È¢ÑËÆæ‰ø°ÊÅØ
                const knowledgeResults = searchFarmKnowledge(message);
                let systemPrompt = `‰Ω†ÊòØÂ∞èÁªøÔºå‰∏Ä‰∏™‰∏ì‰∏öÁöÑÊô∫ÊÖßÂÜúÂú∫Âä©Êâã„ÄÇ‰Ω†ÈúÄË¶ÅÁî®ÂèãÂ•Ω„ÄÅ‰∏ì‰∏öÁöÑËØ≠Ê∞îÂõûÁ≠îÁî®Êà∑ÁöÑÂÜú‰∏öÁõ∏ÂÖ≥ÈóÆÈ¢ò„ÄÇ‰∏ãÈù¢ÊòØÂÖ≥‰∫éËøô‰∏™Êô∫ÊÖßÂÜúÂú∫È°πÁõÆÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÂΩìÁî®Êà∑ÊèêÈóÆÂà∞Áõ∏ÂÖ≥ÈóÆÈ¢òÊó∂‰Ω†Ë¶ÅÂÅöÂá∫ÂØπÂ∫îÂõûÁ≠î„ÄÇ‰∏ãÈù¢ÊòØÊô∫ÊÖßÂÜúÂú∫È°πÁõÆÁöÑÁõ∏ÂÖ≥‰ªãÁªçÔºåÂΩìÁî®Êà∑ÈóÆÂà∞Áõ∏ÂÖ≥ÈóÆÈ¢òÊó∂ÈúÄË¶ÅÂÅöÂá∫ÂØπÂ∫îÂõûÁ≠îÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞È°πÁõÆÊÄªÁªì‰∏é AI ËÆ≤Ëß£ÂêëÂØºÊèêÁ§∫ËØç
‰∏Ä„ÄÅÈ°πÁõÆÊÄªÁªì
Ôºà‰∏ÄÔºâÈ°πÁõÆÊ¶ÇËø∞
Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÊòØ‰∏Ä‰∏™Âü∫‰∫é SpringBoot + Vue Ê°ÜÊû∂ÊäÄÊúØÂºÄÂèëÁöÑ Web Â∫îÁî®Á≥ªÁªüÔºåÊó®Âú®ÈÄöËøáÁßëÊäÄÊâãÊÆµÊèêÂçáÂÜú‰∏öÁîü‰∫ßÊïàÁéáÔºåÂÆûÁé∞ÂÆûÊó∂ÁõëÊµã„ÄÅÊô∫ËÉΩÁÆ°ÁêÜÔºå‰ºòÂåñÂÜú‰∫ßÂìÅË¥®ÈáèÔºåÂØπÁé∞‰ª£ÂÜú‰∏öÂõ≠Âå∫Âª∫ËÆæËµ∑Âà∞Á§∫ËåÉÂ∏¶Âä®‰ΩúÁî®„ÄÇÈöèÁùÄÂÖ®ÁêÉ‰∫∫Âè£Â¢ûÈïøÂíåÁ≤ÆÈ£üÈúÄÊ±ÇÂ¢ûÂä†Ôºå‰º†ÁªüÂÜúÁî∞ÁÆ°ÁêÜÊñπÂºèÂ∑≤Êó†Ê≥ïÊª°Ë∂≥Áé∞‰ª£ÂÜú‰∏öÂèëÂ±ïÈúÄÊ±ÇÔºåÊô∫ÊÖßÂÜúÁî∞Âª∫ËÆæÊàê‰∏∫Ëß£ÂÜ≥‰πãÈÅì„ÄÇÊú¨È°πÁõÆÂ∫îËøêËÄåÁîüÔºåÂÖ∑ÊúâÈáçË¶ÅÁé∞ÂÆûÊÑè‰πâÔºöÊèêÈ´òÁîü‰∫ßÊïàÁéá„ÄÅÂÆûÁé∞Êï∞Â≠óÂåñËΩ¨Âûã„ÄÅ‰øÉËøõÁé∞‰ª£ÂåñÂèëÂ±ï„ÄÅÊèê‰æõÊô∫ËÉΩÂäüËÉΩ„ÄÅÂª∫Á´ãÁÆ°ÁêÜÂπ≥Âè∞„ÄÅÂÆûÁé∞Á≤æÂáÜÊ†∏ÁÆó„ÄÅ‰ºòÂåñÁªèËê•ÁÆ°ÁêÜ„ÄÇ
Ôºà‰∫åÔºâÈúÄÊ±ÇÂàÜÊûê
ÂäüËÉΩÈúÄÊ±Ç ÔºöÁ≥ªÁªüÂàíÂàÜ‰∏∫‰∫îÂ§ßÊ†∏ÂøÉÊ®°ÂùóÔºåÂåÖÊã¨ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜúÂú∫Áâ©ËµÑÁÆ°ÁêÜ‰ª•ÂèäÁ≥ªÁªüÁÆ°ÁêÜ„ÄÇ‰∏çÂêåÁî®Êà∑ËßíËâ≤‰∫´Êúâ‰∏çÂêåÊùÉÈôêÔºåÂÖ∂‰∏≠ÔºåÁÆ°ÁêÜÂëòÊã•ÊúâÁ≥ªÁªüÊúÄÈ´òÊùÉÈôêÔºåË¥üË¥£Á≥ªÁªüÂÖ¨ÂëäÁÆ°ÁêÜ„ÄÅÂÜúÂú∫ÂëòÂ∑•ÁÆ°ÁêÜ„ÄÅËßíËâ≤ÊùÉÈôêÂàÜÈÖç„ÄÅËèúÂçïÈÖçÁΩÆÁ≠âÊ†∏ÂøÉÂäüËÉΩÔºõÂÜúÂú∫ÂëòÂ∑•ÂàôÊ†πÊçÆÂêÑËá™ËßíËâ≤ÔºàÈááË¥≠‰∫∫Âëò„ÄÅÈîÄÂîÆ‰∫∫Âëò„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ‰∫∫ÂëòÔºâ‰ΩøÁî®Áõ∏Â∫îÂäüËÉΩÊ®°ÂùóÔºåÂ¶ÇÁâ©ËµÑÈááË¥≠„ÄÅÂ∫ìÂ≠òÁÆ°ÁêÜ„ÄÅÂÜúÁî∞‰ø°ÊÅØÊü•ÁúãÁ≠â„ÄÇ
ÊäÄÊúØÂèØË°åÊÄßÂàÜÊûê ÔºöÂâçÁ´ØÈááÁî® Vue.js + Element UI ÂÆûÁé∞ÂìçÂ∫îÂºèÁïåÈù¢ÔºåÂêéÁ´Ø‰ΩøÁî® Spring Boot ÊûÑÂª∫ RESTful APIÔºåÂÆûÁé∞ÂâçÂêéÁ´ØËß£ËÄ¶„ÄÇ‰ΩøÁî® MySQL Â≠òÂÇ®‰∏öÂä°Êï∞ÊçÆÔºåÈÄöËøá MyBatis-Plus ÁÆÄÂåñÊï∞ÊçÆËÆøÈóÆÔºåÊîØÊåÅÈ´òÂπ∂ÂèëÂú∫ÊôØ‰∏ãÁöÑÊï∞ÊçÆËØªÂÜô„ÄÇÂêåÊó∂ÔºåÈõÜÊàê ECharts ÂÆûÁé∞Êï∞ÊçÆÂèØËßÜÂåñÔºåÂà©Áî® WebSocket ÂÆûÁé∞ÂÆûÊó∂Ê∂àÊÅØÊé®ÈÄÅÔºåÈááÁî® JWT ÂÆûÁé∞Áî®Êà∑ËÆ§ËØÅ‰∏éÊùÉÈôêÁÆ°ÁêÜ„ÄÇ
Ôºà‰∏âÔºâÁ≥ªÁªüËÆæËÆ°
ÊäÄÊúØÊû∂ÊûÑ ÔºöÈááÁî® B/SÔºàÊµèËßàÂô® / ÊúçÂä°Âô®ÔºâÁªìÊûÑÔºåÂâçÁ´Ø‰ΩøÁî® Vue.js ÂºÄÂèëÔºåÈÄöËøá Axios Âêë Spring Boot ÂêéÁ´ØÂèëÈÄÅ HTTP ËØ∑Ê±ÇÔºåÂêéÁ´Ø‰ª• RESTful API Êé•Âè£ÂΩ¢ÂºèÊèê‰æõÊúçÂä°ÔºåËÆøÈóÆ MySQL Êï∞ÊçÆÂ∫ìÔºåÂÆûÁé∞Á≥ªÁªüÁöÑÈ´òÂÜÖËÅö„ÄÅ‰ΩéËÄ¶Âêà„ÄÇ
Â±ÇÊ¨°ÁªìÊûÑ ÔºöÂâçÁ´ØÂ±ÇË¥üË¥£Áî®Êà∑‰∫§‰∫í‰∏éÁïåÈù¢Â±ïÁ§∫ÔºõÂêéÁ´ØÂ±ÇÂàÜ‰∏∫ÊéßÂà∂Âô®Â±Ç„ÄÅÊúçÂä°Â±Ç„ÄÅÊï∞ÊçÆËÆøÈóÆÂ±Ç„ÄÅÂÆû‰ΩìÂ±ÇÂíåÈÖçÁΩÆÂ±ÇÔºõÊï∞ÊçÆÂ∫ìÂ±ÇÁî®‰∫éÂ≠òÂÇ®Á≥ªÁªüÊï∞ÊçÆÔºåËÆæËÆ° 11 Âº†Ë°®ÔºåÈÄöËøáÂ§ñÈîÆÂÖ≥ËÅîÂÆûÁé∞Êï∞ÊçÆËÅîÂä®„ÄÇ
Áî®‰æãÂª∫Ê®° ÔºöÂõ¥ÁªïÂú®Á∫øÂÆûÊó∂ÁÆ°ÁêÜÂÜúÁî∞Ëøô‰∏Ä‰∏ªÈ¢òÔºåÂ∞ÜÁ≥ªÁªüÂäüËÉΩÂàíÂàÜ‰∏∫‰∫îÂ§ßÊ®°ÂùóÔºåÂàÜÂà´‰∏∫ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜ„ÄÇ‰∏çÂêåËßíËâ≤ÁôªÂΩïÂêéÔºåÂèØÊâßË°åÁõ∏Â∫îÊìç‰ΩúÔºåÂ¶ÇÁÆ°ÁêÜÂëòÂèØËøõË°åÁ≥ªÁªüÂÖ¨ÂëäÁÆ°ÁêÜ„ÄÅÂÜúÂú∫ÂëòÂ∑•ÁÆ°ÁêÜ„ÄÅËßíËâ≤ÊùÉÈôêÂàÜÈÖç„ÄÅËèúÂçïÈÖçÁΩÆÁ≠âÊìç‰ΩúÔºåÂÜúÂú∫ÂëòÂ∑•ÂèØÊü•ÁúãÂÜúÂú∫Á≥ªÁªüÂÖ¨Âëä„ÄÅÂÜúÂú∫ÁéØÂ¢ÉÁõëÊµãÁªìÊûúÂíåÂÜúÁî∞Âü∫Êú¨‰ø°ÊÅØÁ≠â„ÄÇ
Á≥ªÁªüËØ¶ÁªÜËÆæËÆ° ÔºöÊòéÁ°ÆÂêÑÁ±ªÁî®Êà∑ÔºàÂÜúÂú∫ÁÆ°ÁêÜÂëò„ÄÅÊôÆÈÄöÂëòÂ∑•ÔºâÁöÑÁôªÂΩïÂèäÊìç‰ΩúÊµÅÁ®ã„ÄÇÂÜúÂú∫ÁÆ°ÁêÜÂëòÂèØÊìç‰ΩúÁ≥ªÁªüÊâÄÊúâÊ®°ÂùóÔºåÂåÖÊã¨ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜÔºõÊôÆÈÄöÂëòÂ∑•ÁôªÂΩïÂêéÔºåÂèØÂØπÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜÁ≠âÊ®°ÂùóËøõË°åÁÆ°ÁêÜ„ÄÇ
ÔºàÂõõÔºâÁ≥ªÁªüÂÆûÁé∞
ÂâçÁ´ØÂºÄÂèë ÔºöÊäÄÊúØÊ†à‰∏∫ Vue.js + Vue Router + Vuex + Element UI + Axios„ÄÇÂÆûÁé∞ÂÖ≥ÈîÆÂäüËÉΩÂåÖÊã¨Âä®ÊÄÅË∑ØÁî±ÔºàÊ†πÊçÆÁî®Êà∑ËßíËâ≤Âä®ÊÄÅÂä†ËΩΩÂèØËÆøÈóÆÁöÑËèúÂçïË∑ØÁî±ÔºåÂÆûÁé∞ÊùÉÈôêÈöîÁ¶ªÔºâ„ÄÅÊï∞ÊçÆÂèØËßÜÂåñÔºà‰ΩøÁî® ECharts ÁªòÂà∂ÁéØÂ¢ÉÊï∞ÊçÆÊäòÁ∫øÂõæ„ÄÅÊü±Áä∂ÂõæÔºåÊîØÊåÅÊó∂Èó¥ËåÉÂõ¥Á≠õÈÄâÔºâ„ÄÅÊñá‰ª∂Êìç‰ΩúÔºàÈÄöËøá Element UI ÁöÑ Upload ÁªÑ‰ª∂ÂÆûÁé∞ Excel Êñá‰ª∂ÂØºÂÖ•ÔºåË∞ÉÁî® Blob ÂØπË±°ÂÆûÁé∞Êï∞ÊçÆÂØºÂá∫Ôºâ„ÄÇ
ÂêéÁ´ØÂºÄÂèë ÔºöÊäÄÊúØÊ†à‰∏∫ Spring Boot + MyBatis-Plus + MySQL + JWT + WebSocket„ÄÇÂÆûÁé∞ÂÖ≥ÈîÆÂäüËÉΩÂåÖÊã¨ÊùÉÈôêÁÆ°ÁêÜÔºàÈÄöËøá JwtInterceptor Êã¶Êà™Âô®È™åËØÅÁî®Êà∑ TokenÔºåÁªìÂêà RoleEnum Êûö‰∏æÁ±ªÂÆûÁé∞ËßíËâ≤ÊùÉÈôêÊéßÂà∂Ôºâ„ÄÅÊï∞ÊçÆÁªüËÆ°Ôºà‰ΩøÁî® MyBatis-Plus ÁöÑ Wrapper Ë°®ËææÂºèÂÆûÁé∞Â§çÊùÇÊü•ËØ¢ÔºåÂ¶ÇÊåâÊó∂Èó¥ÁªüËÆ°ÂÜúÁî∞ÁéØÂ¢ÉÊï∞ÊçÆÂπ≥ÂùáÂÄºÔºâ„ÄÅÂÆûÊó∂ÈÄö‰ø°ÔºàÈõÜÊàê WebSocket ÂÆûÁé∞Â∫ìÂ≠òÈ¢ÑË≠¶„ÄÅÂÖ¨ÂëäÊé®ÈÄÅÁ≠âÊ∂àÊÅØÁöÑÂÆûÊó∂ÈÄöÁü•Ôºâ„ÄÇ
Ôºà‰∫îÔºâÈÉ®ÁΩ≤‰∏éËøêË°å
ÁéØÂ¢ÉË¶ÅÊ±Ç ÔºöJDK 1.8+„ÄÅNode.js 12+„ÄÅMySQL 5.7+„ÄÅMaven 3.6+„ÄÇ
ÂâçÁ´ØÈÉ®ÁΩ≤ ÔºöÈÄöËøá git ÂÖãÈöÜÈ°πÁõÆÔºåËøõÂÖ•ÂâçÁ´ØÈ°πÁõÆÁõÆÂΩïÔºåÂÆâË£Ö‰æùËµñÔºåÂèØÂêØÂä®ÂºÄÂèëÊúçÂä°Âô®ÊàñÊûÑÂª∫Áîü‰∫ßÁéØÂ¢É„ÄÇ
ÂêéÁ´ØÈÉ®ÁΩ≤ ÔºöËøõÂÖ•ÂêéÁ´ØÈ°πÁõÆÁõÆÂΩïÔºå‰ΩøÁî® Maven ÊûÑÂª∫È°πÁõÆÔºåËøêË°å JAR Êñá‰ª∂Âç≥ÂèØ„ÄÇ
Á≥ªÁªüËøêË°å ÔºöÁî®Êà∑ÁôªÂΩïÂêéÔºåÊ†πÊçÆ‰∏çÂêåËßíËâ≤ÂèØÊü•Áúã‰∏çÂêåÈ°µÈù¢ÂíåÊùÉÈôêÔºåÁ≥ªÁªü‰∏ªË¶ÅÂäüËÉΩÊ®°ÂùóÂåÖÊã¨ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜ‰∫îÂ§ßÊ®°Âùó„ÄÇ
ÔºàÂÖ≠ÔºâÈ°πÁõÆÊàêÊûú‰∏éÊÄªÁªì
È°πÁõÆÊàêÂäüÊê≠Âª∫‰∫Ü‰∏Ä‰∏™ÈõÜÂÆûÊó∂ÁõëÊµã„ÄÅÊô∫ËÉΩÁÆ°ÁêÜÁ≠âÂäüËÉΩ‰∫é‰∏Ä‰ΩìÁöÑÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÂÆûÁé∞‰∫ÜÂØπÂÜúÁî∞ÁöÑÂÖ®Êñπ‰ΩçÊô∫ËÉΩÂåñÁÆ°ÁêÜÔºåÊúâÊïàÊèêÈ´ò‰∫ÜÂÜú‰∏öÁîü‰∫ßÊïàÁéá„ÄÅËµÑÊ∫êÂà©Áî®Áéá‰ª•ÂèäÂÜú‰∫ßÂìÅË¥®ÈáèÂÆâÂÖ®ÔºåÊé®Âä®‰∫ÜÂÜú‰∏öÂèØÊåÅÁª≠ÂèëÂ±ï„ÄÇÈ°πÁõÆÁªÑÊàêÂëòÂú®ÊäÄÊúØËÉΩÂäõ„ÄÅÂõ¢ÈòüÂçè‰Ωú‰∏éÁÆ°ÁêÜÁ≠âÊñπÈù¢ÂùáÂèñÂæó‰∫ÜÊòæËëóÊàêÈïøÔºå‰∏∫Êú™Êù•Âú®Êô∫ÊÖßÂÜú‰∏öÈ¢ÜÂüüÁöÑËøõ‰∏ÄÊ≠•ÂèëÂ±ïÂ•†ÂÆö‰∫ÜÂùöÂÆûÂü∫Á°Ä„ÄÇ
‰∫å„ÄÅAI ËÆ≤Ëß£ÂêëÂØºÊèêÁ§∫ËØç
Ôºà‰∏ÄÔºâÈ°πÁõÆ‰ªãÁªç
ËØ∑ÁÆÄË¶Å‰ªãÁªçÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞È°πÁõÆËÉåÊôØ„ÄÇ
Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞È°πÁõÆÊó®Âú®Â∫îÂØπÂÖ®ÁêÉ‰∫∫Âè£Â¢ûÈïøÂíåÁ≤ÆÈ£üÈúÄÊ±ÇÂ¢ûÂä†ÁöÑÊåëÊàòÔºå‰º†ÁªüÂÜúÁî∞ÁÆ°ÁêÜÊñπÂºèÊïàÁéá‰ΩéÔºåÈöæ‰ª•Êª°Ë∂≥Áé∞‰ª£ÂÜú‰∏öÂèëÂ±ïÈúÄÊ±Ç„ÄÇÊô∫ÊÖßÂÜúÁî∞Âª∫ËÆæÊàê‰∏∫ÊèêÂçáÂÜú‰∏öÁîü‰∫ßÊïàÁéá„ÄÅÈôç‰ΩéÁîü‰∫ßÊàêÊú¨„ÄÅËäÇÁ∫¶ËµÑÊ∫ê„ÄÅ‰øùÊä§ÁéØÂ¢ÉÁöÑÊúâÊïàÈÄîÂæÑÔºåÂÖ∑ÊúâÊòæËëóÁöÑÁªèÊµéÊïàÁõäÂíåÁ§æ‰ºöÊïàÁõä„ÄÇ
Êú¨È°πÁõÆÁöÑÁõÆÊ†áÊòØ‰ªÄ‰πàÔºü
ÈÄöËøáÂºÄÂèëÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÂÆûÁé∞ÂØπÂÜúÁî∞ÁöÑÂÆûÊó∂ÁõëÊµãÔºåËé∑ÂèñÁéØÂ¢ÉÊï∞ÊçÆ„ÄÅ‰ΩúÁâ©ÁîüÈïø‰ø°ÊÅØÁ≠âÂÖ≥ÈîÆÊåáÊ†áÔºõÊèê‰æõÈ´òÊïàÁöÑÂÜúÁî∞ÁÆ°ÁêÜÂäüËÉΩÔºåÂåÖÊã¨ÂÜúÁî∞‰ø°ÊÅØÁÆ°ÁêÜ„ÄÅÁéØÂ¢ÉÁõëÊµã„ÄÅËßÜÈ¢ëÁõëÊéßÁ≠âÔºõÂÆûÁé∞Á≤æÂáÜÁöÑÂÜ≥Á≠ñÊîØÊåÅÔºåÈÄöËøáÊï∞ÊçÆÂàÜÊûê‰∏∫ÂÜúÊà∑Êèê‰æõÁßëÂ≠¶ÁöÑÁîü‰∫ßÂª∫ËÆÆÔºõÊé®Âä®ÂÜú‰∏öÂèØÊåÅÁª≠ÂèëÂ±ïÔºåÊèêÈ´òÁîü‰∫ßÊïàÁéáÔºåÈôç‰ΩéËµÑÊ∫êÊµ™Ë¥πÔºå‰øùÈöúÂÜú‰∫ßÂìÅË¥®ÈáèÂÆâÂÖ®„ÄÇ
Ôºà‰∫åÔºâÈúÄÊ±ÇÂàÜÊûê
ËØ∑ÈòêËø∞Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÁöÑÂäüËÉΩÈúÄÊ±Ç„ÄÇ
Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÁöÑÂäüËÉΩÈúÄÊ±ÇÊ∂µÁõñ‰∫îÂ§ßÊ†∏ÂøÉÊ®°Âùó„ÄÇÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•Ê®°ÂùóÁî®‰∫éÂ±ïÁ§∫Á≥ªÁªüÈÄöÁü•ÔºåÂ¶ÇÂ§©Ê∞îÈ¢ÑË≠¶„ÄÅÁóÖËô´ÂÆ≥Èò≤Ê≤ªÁü•ËØÜÔºåÊîØÊåÅÁÆ°ÁêÜÂëòÂèëÂ∏É„ÄÅÁºñËæë„ÄÅÂà†Èô§ÂÖ¨Âëä„ÄÇÂÜúÂú∫ÁªüËÆ°ÂàÜÊûêÊ®°ÂùóÂåÖÊã¨ÁéØÂ¢ÉÁõëÊµãÔºåÂÆûÊó∂Â±ïÁ§∫ÂÖâÁÖßÂº∫Â∫¶„ÄÅÊ∏©Â∫¶„ÄÅÊπøÂ∫¶„ÄÅÂúüÂ£§ pH ÂÄºÁ≠âÊï∞ÊçÆÔºåÂπ∂ÈÄöËøá ECharts ÁîüÊàêË∂ãÂäøÂõæË°®ÔºåÂêåÊó∂Êé•ÂÖ•ÂÜúÁî∞ÊëÑÂÉèÂ§¥ÂÆûÁé∞ËøúÁ®ãÂÆûÊó∂ÁîªÈù¢Êü•Áúã„ÄÇÂÜúÁî∞ÁÆ°ÁêÜÊ®°ÂùóÊîØÊåÅÂÜúÁî∞‰ø°ÊÅØÁöÑÊñ∞Â¢û„ÄÅÁºñËæë„ÄÅÂà†Èô§ÂèäÊâπÈáèÊìç‰ΩúÔºåÂèØÂØºÂá∫ Excel Êï∞ÊçÆÔºåÊü•ÁúãÂçïÂùóÂÜúÁî∞ÁöÑ‰ΩúÁâ©ÁîüÈïøÁä∂ÊÄÅ„ÄÅÁéØÂ¢ÉÂèÇÊï∞Á≠âËØ¶ÊÉÖ„ÄÇÂÜúËµÑÁÆ°ÁêÜÊ®°ÂùóÂåÖÂê´Áâ©ËµÑÈááË¥≠ÔºåËÆ∞ÂΩïÂåñËÇ•„ÄÅÈô§ËçâÂâÇÁ≠âÁâ©ËµÑÁöÑÈááË¥≠ËÆ∞ÂΩïÔºåÊîØÊåÅ Excel ÂØºÂÖ• / ÂØºÂá∫Ôºå‰ª•ÂèäÂ∫ìÂ≠òÁÆ°ÁêÜÔºåÂÆûÊó∂Ë∑üË∏™Áâ©ËµÑÂ∫ìÂ≠òÊï∞ÈáèÔºå‰ΩéÂ∫ìÂ≠òËá™Âä®È¢ÑË≠¶ÔºåËøòÊúâÂÜú‰ΩúÁâ©Âá∫ÂîÆÁÆ°ÁêÜÂÜú‰∫ßÂìÅÈîÄÂîÆËÆ∞ÂΩïÔºåÁªüËÆ°ÈîÄÂîÆÊ∏†ÈÅì‰∏éÊî∂Áõä„ÄÇÁ≥ªÁªüÁÆ°ÁêÜÊ®°ÂùóÂàôÊ∂âÂèäÂëòÂ∑•ÁÆ°ÁêÜÔºåÁª¥Êä§ÂëòÂ∑•Ë¥¶Âè∑‰ø°ÊÅØÔºåÂàÜÈÖçËßíËâ≤ÔºåËßíËâ≤ÊùÉÈôêÈÖçÁΩÆÈÄöËøá RBAC Ê®°ÂûãÂÆûÁé∞ÁªÜÁ≤íÂ∫¶ËÆøÈóÆÊéßÂà∂ÔºåËèúÂçïÁÆ°ÁêÜÊîØÊåÅÂä®ÊÄÅË∞ÉÊï¥Á≥ªÁªüÂäüËÉΩËèúÂçïÔºå‰ª•ÂèäÂç≥Êó∂ÈÄöËÆØÂäüËÉΩÔºåÂÆûÁé∞Ê∂àÊÅØÁöÑÂÆûÊó∂Êé®ÈÄÅ„ÄÅÂéÜÂè≤Ê∂àÊÅØÊü•ËØ¢„ÄÅÁæ§ÁªÑËÅäÂ§©Á≠â„ÄÇ
ËØ•È°πÁõÆÁöÑÊäÄÊúØÂèØË°åÊÄßÂàÜÊûêÊòØÊÄéÊ†∑ÁöÑÔºü
ÂâçÁ´ØÈááÁî® Vue.js + Element UI ÂÆûÁé∞ÂìçÂ∫îÂºèÁïåÈù¢ÔºåÂêéÁ´Ø‰ΩøÁî® Spring Boot ÊûÑÂª∫ RESTful APIÔºåÂÆûÁé∞ÂâçÂêéÁ´ØËß£ËÄ¶„ÄÇ‰ΩøÁî® MySQL Â≠òÂÇ®‰∏öÂä°Êï∞ÊçÆÔºåÈÄöËøá MyBatis-Plus ÁÆÄÂåñÊï∞ÊçÆËÆøÈóÆÔºåÊîØÊåÅÈ´òÂπ∂ÂèëÂú∫ÊôØ‰∏ãÁöÑÊï∞ÊçÆËØªÂÜô„ÄÇÈõÜÊàê ECharts ÂÆûÁé∞Êï∞ÊçÆÂèØËßÜÂåñÔºåÂà©Áî® WebSocket ÂÆûÁé∞ÂÆûÊó∂Ê∂àÊÅØÊé®ÈÄÅÔºåÈááÁî® JWT ÂÆûÁé∞Áî®Êà∑ËÆ§ËØÅ‰∏éÊùÉÈôêÁÆ°ÁêÜÔºåËøô‰∫õÊäÄÊúØÈÄâÂûãÁ°Æ‰øù‰∫ÜÈ°πÁõÆÁöÑÂèØË°åÊÄßÂíåÂèØÂÆûÊñΩÊÄß„ÄÇ
Ôºà‰∏âÔºâÁ≥ªÁªüËÆæËÆ°
ËØ∑ÊèèËø∞Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÁöÑÊäÄÊúØÊû∂ÊûÑ„ÄÇ
ÈááÁî® B/SÔºàÊµèËßàÂô® / ÊúçÂä°Âô®ÔºâÁªìÊûÑÔºåÂâçÁ´Ø‰ΩøÁî® Vue.js ÂºÄÂèëÔºåÈÄöËøá Axios Âêë Spring Boot ÂêéÁ´ØÂèëÈÄÅ HTTP ËØ∑Ê±ÇÔºåÂêéÁ´Ø‰ª• RESTful API Êé•Âè£ÂΩ¢ÂºèÊèê‰æõÊúçÂä°ÔºåËÆøÈóÆ MySQL Êï∞ÊçÆÂ∫ìÔºåÂÆûÁé∞Á≥ªÁªüÁöÑÈ´òÂÜÖËÅö„ÄÅ‰ΩéËÄ¶Âêà„ÄÇ
Â±ÇÊ¨°ÁªìÊûÑ ÔºöÂâçÁ´ØÂ±ÇË¥üË¥£Áî®Êà∑‰∫§‰∫í‰∏éÁïåÈù¢Â±ïÁ§∫ÔºõÂêéÁ´ØÂ±ÇÂàÜ‰∏∫ÊéßÂà∂Âô®Â±Ç„ÄÅÊúçÂä°Â±Ç„ÄÅÊï∞ÊçÆËÆøÈóÆÂ±Ç„ÄÅÂÆû‰ΩìÂ±ÇÂíåÈÖçÁΩÆÂ±ÇÔºõÊï∞ÊçÆÂ∫ìÂ±ÇÁî®‰∫éÂ≠òÂÇ®Á≥ªÁªüÊï∞ÊçÆÔºåËÆæËÆ° 11 Âº†Ë°®ÔºåÈÄöËøáÂ§ñÈîÆÂÖ≥ËÅîÂÆûÁé∞Êï∞ÊçÆËÅîÂä®„ÄÇ
Áî®‰æãÂª∫Ê®° ÔºöÂõ¥ÁªïÂú®Á∫øÂÆûÊó∂ÁÆ°ÁêÜÂÜúÁî∞Ëøô‰∏Ä‰∏ªÈ¢òÔºåÂ∞ÜÁ≥ªÁªüÂäüËÉΩÂàíÂàÜ‰∏∫‰∫îÂ§ßÊ®°ÂùóÔºåÂàÜÂà´‰∏∫ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜ„ÄÇ‰∏çÂêåËßíËâ≤ÁôªÂΩïÂêéÔºåÂèØÊâßË°åÁõ∏Â∫îÊìç‰ΩúÔºåÂ¶ÇÁÆ°ÁêÜÂëòÂèØËøõË°åÁ≥ªÁªüÂÖ¨ÂëäÁÆ°ÁêÜ„ÄÅÂÜúÂú∫ÂëòÂ∑•ÁÆ°ÁêÜ„ÄÅËßíËâ≤ÊùÉÈôêÂàÜÈÖç„ÄÅËèúÂçïÈÖçÁΩÆÁ≠âÊìç‰ΩúÔºåÂÜúÂú∫ÂëòÂ∑•ÂèØÊü•ÁúãÂÜúÂú∫Á≥ªÁªüÂÖ¨Âëä„ÄÅÂÜúÂú∫ÁéØÂ¢ÉÁõëÊµãÁªìÊûúÂíåÂÜúÁî∞Âü∫Êú¨‰ø°ÊÅØÁ≠â„ÄÇ
Á≥ªÁªüËØ¶ÁªÜËÆæËÆ° ÔºöÊòéÁ°ÆÂêÑÁ±ªÁî®Êà∑ÔºàÂÜúÂú∫ÁÆ°ÁêÜÂëò„ÄÅÊôÆÈÄöÂëòÂ∑•ÔºâÁöÑÁôªÂΩïÂèäÊìç‰ΩúÊµÅÁ®ã„ÄÇÂÜúÂú∫ÁÆ°ÁêÜÂëòÂèØÊìç‰ΩúÁ≥ªÁªüÊâÄÊúâÊ®°ÂùóÔºåÂåÖÊã¨ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜÔºõÊôÆÈÄöÂëòÂ∑•ÁôªÂΩïÂêéÔºåÂèØÂØπÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜÁ≠âÊ®°ÂùóËøõË°åÁÆ°ÁêÜ„ÄÇ
ÔºàÂõõÔºâÁ≥ªÁªüÂÆûÁé∞
ÂâçÁ´ØÂºÄÂèë ÔºöÊäÄÊúØÊ†à‰∏∫ Vue.js + Vue Router + Vuex + Element UI + Axios„ÄÇÂÆûÁé∞ÂÖ≥ÈîÆÂäüËÉΩÂåÖÊã¨Âä®ÊÄÅË∑ØÁî±ÔºàÊ†πÊçÆÁî®Êà∑ËßíËâ≤Âä®ÊÄÅÂä†ËΩΩÂèØËÆøÈóÆÁöÑËèúÂçïË∑ØÁî±ÔºåÂÆûÁé∞ÊùÉÈôêÈöîÁ¶ªÔºâ„ÄÅÊï∞ÊçÆÂèØËßÜÂåñÔºà‰ΩøÁî® ECharts ÁªòÂà∂ÁéØÂ¢ÉÊï∞ÊçÆÊäòÁ∫øÂõæ„ÄÅÊü±Áä∂ÂõæÔºåÊîØÊåÅÊó∂Èó¥ËåÉÂõ¥Á≠õÈÄâÔºâ„ÄÅÊñá‰ª∂Êìç‰ΩúÔºàÈÄöËøá Element UI ÁöÑ Upload ÁªÑ‰ª∂ÂÆûÁé∞ Excel Êñá‰ª∂ÂØºÂÖ•ÔºåË∞ÉÁî® Blob ÂØπË±°ÂÆûÁé∞Êï∞ÊçÆÂØºÂá∫Ôºâ„ÄÇ
ÂêéÁ´ØÂºÄÂèë ÔºöÊäÄÊúØÊ†à‰∏∫ Spring Boot + MyBatis-Plus + MySQL + JWT + WebSocket„ÄÇÂÆûÁé∞ÂÖ≥ÈîÆÂäüËÉΩÂåÖÊã¨ÊùÉÈôêÁÆ°ÁêÜÔºàÈÄöËøá JwtInterceptor Êã¶Êà™Âô®È™åËØÅÁî®Êà∑ TokenÔºåÁªìÂêà RoleEnum Êûö‰∏æÁ±ªÂÆûÁé∞ËßíËâ≤ÊùÉÈôêÊéßÂà∂Ôºâ„ÄÅÊï∞ÊçÆÁªüËÆ°Ôºà‰ΩøÁî® MyBatis-Plus ÁöÑ Wrapper Ë°®ËææÂºèÂÆûÁé∞Â§çÊùÇÊü•ËØ¢ÔºåÂ¶ÇÊåâÊó∂Èó¥ÁªüËÆ°ÂÜúÁî∞ÁéØÂ¢ÉÊï∞ÊçÆÂπ≥ÂùáÂÄºÔºâ„ÄÅÂÆûÊó∂ÈÄö‰ø°ÔºàÈõÜÊàê WebSocket ÂÆûÁé∞Â∫ìÂ≠òÈ¢ÑË≠¶„ÄÅÂÖ¨ÂëäÊé®ÈÄÅÁ≠âÊ∂àÊÅØÁöÑÂÆûÊó∂ÈÄöÁü•Ôºâ„ÄÇ
Ôºà‰∫îÔºâÈÉ®ÁΩ≤‰∏éËøêË°å
ÁéØÂ¢ÉË¶ÅÊ±Ç ÔºöJDK 1.8+„ÄÅNode.js 12+„ÄÅMySQL 5.7+„ÄÅMaven 3.6+„ÄÇ
ÂâçÁ´ØÈÉ®ÁΩ≤ ÔºöÈÄöËøá git ÂÖãÈöÜÈ°πÁõÆÔºåËøõÂÖ•ÂâçÁ´ØÈ°πÁõÆÁõÆÂΩïÔºåÂÆâË£Ö‰æùËµñÔºåÂèØÂêØÂä®ÂºÄÂèëÊúçÂä°Âô®ÊàñÊûÑÂª∫Áîü‰∫ßÁéØÂ¢É„ÄÇ
ÂêéÁ´ØÈÉ®ÁΩ≤ ÔºöËøõÂÖ•ÂêéÁ´ØÈ°πÁõÆÁõÆÂΩïÔºå‰ΩøÁî® Maven ÊûÑÂª∫È°πÁõÆÔºåËøêË°å JAR Êñá‰ª∂Âç≥ÂèØ„ÄÇ
Á≥ªÁªüËøêË°å ÔºöÁî®Êà∑ÁôªÂΩïÂêéÔºåÊ†πÊçÆ‰∏çÂêåËßíËâ≤ÂèØÊü•Áúã‰∏çÂêåÈ°µÈù¢ÂíåÊùÉÈôêÔºåÁ≥ªÁªü‰∏ªË¶ÅÂäüËÉΩÊ®°ÂùóÂåÖÊã¨ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜ‰∫îÂ§ßÊ®°Âùó„ÄÇ
ÔºàÂÖ≠ÔºâÈ°πÁõÆÊàêÊûú‰∏éÊÄªÁªì
È°πÁõÆÊàêÂäüÊê≠Âª∫‰∫Ü‰∏Ä‰∏™ÈõÜÂÆûÊó∂ÁõëÊµã„ÄÅÊô∫ËÉΩÁÆ°ÁêÜÁ≠âÂäüËÉΩ‰∫é‰∏Ä‰ΩìÁöÑÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÂÆûÁé∞‰∫ÜÂØπÂÜúÁî∞ÁöÑÂÖ®Êñπ‰ΩçÊô∫ËÉΩÂåñÁÆ°ÁêÜÔºåÊúâÊïàÊèêÈ´ò‰∫ÜÂÜú‰∏öÁîü‰∫ßÊïàÁéá„ÄÅËµÑÊ∫êÂà©Áî®Áéá‰ª•ÂèäÂÜú‰∫ßÂìÅË¥®ÈáèÂÆâÂÖ®ÔºåÊé®Âä®‰∫ÜÂÜú‰∏öÂèØÊåÅÁª≠ÂèëÂ±ï„ÄÇÈ°πÁõÆÁªÑÊàêÂëòÂú®ÊäÄÊúØËÉΩÂäõ„ÄÅÂõ¢ÈòüÂçè‰Ωú‰∏éÁÆ°ÁêÜÁ≠âÊñπÈù¢ÂùáÂèñÂæó‰∫ÜÊòæËëóÊàêÈïøÔºå‰∏∫Êú™Êù•Âú®Êô∫ÊÖßÂÜú‰∏öÈ¢ÜÂüüÁöÑËøõ‰∏ÄÊ≠•ÂèëÂ±ïÂ•†ÂÆö‰∫ÜÂùöÂÆûÂü∫Á°Ä„ÄÇ
‰∫å„ÄÅAI ËÆ≤Ëß£ÂêëÂØºÊèêÁ§∫ËØç
Ôºà‰∏ÄÔºâÈ°πÁõÆ‰ªãÁªç
ËØ∑ÁÆÄË¶Å‰ªãÁªçÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞È°πÁõÆËÉåÊôØ„ÄÇ
Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞È°πÁõÆÊó®Âú®Â∫îÂØπÂÖ®ÁêÉ‰∫∫Âè£Â¢ûÈïøÂíåÁ≤ÆÈ£üÈúÄÊ±ÇÂ¢ûÂä†ÁöÑÊåëÊàòÔºå‰º†ÁªüÂÜúÁî∞ÁÆ°ÁêÜÊñπÂºèÊïàÁéá‰ΩéÔºåÈöæ‰ª•Êª°Ë∂≥Áé∞‰ª£ÂÜú‰∏öÂèëÂ±ïÈúÄÊ±Ç„ÄÇÊô∫ÊÖßÂÜúÁî∞Âª∫ËÆæÊàê‰∏∫ÊèêÂçáÂÜú‰∏öÁîü‰∫ßÊïàÁéá„ÄÅÈôç‰ΩéÁîü‰∫ßÊàêÊú¨„ÄÅËäÇÁ∫¶ËµÑÊ∫ê„ÄÅ‰øùÊä§ÁéØÂ¢ÉÁöÑÊúâÊïàÈÄîÂæÑÔºåÂÖ∑ÊúâÊòæËëóÁöÑÁªèÊµéÊïàÁõäÂíåÁ§æ‰ºöÊïàÁõä„ÄÇ
Êú¨È°πÁõÆÁöÑÁõÆÊ†áÊòØ‰ªÄ‰πàÔºü
ÈÄöËøáÂºÄÂèëÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÂÆûÁé∞ÂØπÂÜúÁî∞ÁöÑÂÆûÊó∂ÁõëÊµãÔºåËé∑ÂèñÁéØÂ¢ÉÊï∞ÊçÆ„ÄÅ‰ΩúÁâ©ÁîüÈïø‰ø°ÊÅØÁ≠âÂÖ≥ÈîÆÊåáÊ†áÔºõÊèê‰æõÈ´òÊïàÁöÑÂÜúÁî∞ÁÆ°ÁêÜÂäüËÉΩÔºåÂåÖÊã¨ÂÜúÁî∞‰ø°ÊÅØÁÆ°ÁêÜ„ÄÅÁéØÂ¢ÉÁõëÊµã„ÄÅËßÜÈ¢ëÁõëÊéßÁ≠âÔºõÂÆûÁé∞Á≤æÂáÜÁöÑÂÜ≥Á≠ñÊîØÊåÅÔºåÈÄöËøáÊï∞ÊçÆÂàÜÊûê‰∏∫ÂÜúÊà∑Êèê‰æõÁßëÂ≠¶ÁöÑÁîü‰∫ßÂª∫ËÆÆÔºõÊé®Âä®ÂÜú‰∏öÂèØÊåÅÁª≠ÂèëÂ±ïÔºåÊèêÈ´òÁîü‰∫ßÊïàÁéáÔºåÈôç‰ΩéËµÑÊ∫êÊµ™Ë¥πÔºå‰øùÈöúÂÜú‰∫ßÂìÅË¥®ÈáèÂÆâÂÖ®„ÄÇ
Ôºà‰∫åÔºâÈúÄÊ±ÇÂàÜÊûê
ËØ∑ÈòêËø∞Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÁöÑÂäüËÉΩÈúÄÊ±Ç„ÄÇ
Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÁöÑÂäüËÉΩÈúÄÊ±ÇÊ∂µÁõñ‰∫îÂ§ßÊ†∏ÂøÉÊ®°Âùó„ÄÇÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•Ê®°ÂùóÁî®‰∫éÂ±ïÁ§∫Á≥ªÁªüÈÄöÁü•ÔºåÂ¶ÇÂ§©Ê∞îÈ¢ÑË≠¶„ÄÅÁóÖËô´ÂÆ≥Èò≤Ê≤ªÁü•ËØÜÔºåÊîØÊåÅÁÆ°ÁêÜÂëòÂèëÂ∏É„ÄÅÁºñËæë„ÄÅÂà†Èô§ÂÖ¨Âëä„ÄÇÂÜúÂú∫ÁªüËÆ°ÂàÜÊûêÊ®°ÂùóÂåÖÊã¨ÁéØÂ¢ÉÁõëÊµãÔºåÂÆûÊó∂Â±ïÁ§∫ÂÖâÁÖßÂº∫Â∫¶„ÄÅÊ∏©Â∫¶„ÄÅÊπøÂ∫¶„ÄÅÂúüÂ£§ pH ÂÄºÁ≠âÊï∞ÊçÆÔºåÂπ∂ÈÄöËøá ECharts ÁîüÊàêË∂ãÂäøÂõæË°®ÔºåÂêåÊó∂Êé•ÂÖ•ÂÜúÁî∞ÊëÑÂÉèÂ§¥ÂÆûÁé∞ËøúÁ®ãÂÆûÊó∂ÁîªÈù¢Êü•Áúã„ÄÇÂÜúÁî∞ÁÆ°ÁêÜÊ®°ÂùóÊîØÊåÅÂÜúÁî∞‰ø°ÊÅØÁöÑÊñ∞Â¢û„ÄÅÁºñËæë„ÄÅÂà†Èô§ÂèäÊâπÈáèÊìç‰ΩúÔºåÂèØÂØºÂá∫ Excel Êï∞ÊçÆÔºåÊü•ÁúãÂçïÂùóÂÜúÁî∞ÁöÑ‰ΩúÁâ©ÁîüÈïøÁä∂ÊÄÅ„ÄÅÁéØÂ¢ÉÂèÇÊï∞Á≠âËØ¶ÊÉÖ„ÄÇÂÜúËµÑÁÆ°ÁêÜÊ®°ÂùóÂåÖÂê´Áâ©ËµÑÈááË¥≠ÔºåËÆ∞ÂΩïÂåñËÇ•„ÄÅÈô§ËçâÂâÇÁ≠âÁâ©ËµÑÁöÑÈááË¥≠ËÆ∞ÂΩïÔºåÊîØÊåÅ Excel ÂØºÂÖ• / ÂØºÂá∫Ôºå‰ª•ÂèäÂ∫ìÂ≠òÁÆ°ÁêÜÔºåÂÆûÊó∂Ë∑üË∏™Áâ©ËµÑÂ∫ìÂ≠òÊï∞ÈáèÔºå‰ΩéÂ∫ìÂ≠òËá™Âä®È¢ÑË≠¶ÔºåËøòÊúâÂÜú‰ΩúÁâ©Âá∫ÂîÆÁÆ°ÁêÜÂÜú‰∫ßÂìÅÈîÄÂîÆËÆ∞ÂΩïÔºåÁªüËÆ°ÈîÄÂîÆÊ∏†ÈÅì‰∏éÊî∂Áõä„ÄÇÁ≥ªÁªüÁÆ°ÁêÜÊ®°ÂùóÂàôÊ∂âÂèäÂëòÂ∑•ÁÆ°ÁêÜÔºåÁª¥Êä§ÂëòÂ∑•Ë¥¶Âè∑‰ø°ÊÅØÔºåÂàÜÈÖçËßíËâ≤ÔºåËßíËâ≤ÊùÉÈôêÈÖçÁΩÆÈÄöËøá RBAC Ê®°ÂûãÂÆûÁé∞ÁªÜÁ≤íÂ∫¶ËÆøÈóÆÊéßÂà∂ÔºåËèúÂçïÁÆ°ÁêÜÊîØÊåÅÂä®ÊÄÅË∞ÉÊï¥Á≥ªÁªüÂäüËÉΩËèúÂçïÔºå‰ª•ÂèäÂç≥Êó∂ÈÄöËÆØÂäüËÉΩÔºåÂÆûÁé∞Ê∂àÊÅØÁöÑÂÆûÊó∂Êé®ÈÄÅ„ÄÅÂéÜÂè≤Ê∂àÊÅØÊü•ËØ¢„ÄÅÁæ§ÁªÑËÅäÂ§©Á≠â„ÄÇ
ËØ•È°πÁõÆÁöÑÊäÄÊúØÂèØË°åÊÄßÂàÜÊûêÊòØÊÄéÊ†∑ÁöÑÔºü
ÂâçÁ´ØÈááÁî® Vue.js + Element UI ÂÆûÁé∞ÂìçÂ∫îÂºèÁïåÈù¢ÔºåÂêéÁ´Ø‰ΩøÁî® Spring Boot ÊûÑÂª∫ RESTful APIÔºåÂÆûÁé∞ÂâçÂêéÁ´ØËß£ËÄ¶„ÄÇ‰ΩøÁî® MySQL Â≠òÂÇ®‰∏öÂä°Êï∞ÊçÆÔºåÈÄöËøá MyBatis-Plus ÁÆÄÂåñÊï∞ÊçÆËÆøÈóÆÔºåÊîØÊåÅÈ´òÂπ∂ÂèëÂú∫ÊôØ‰∏ãÁöÑÊï∞ÊçÆËØªÂÜô„ÄÇÈõÜÊàê ECharts ÂÆûÁé∞Êï∞ÊçÆÂèØËßÜÂåñÔºåÂà©Áî® WebSocket ÂÆûÁé∞ÂÆûÊó∂Ê∂àÊÅØÊé®ÈÄÅÔºåÈááÁî® JWT ÂÆûÁé∞Áî®Êà∑ËÆ§ËØÅ‰∏éÊùÉÈôêÁÆ°ÁêÜÔºåËøô‰∫õÊäÄÊúØÈÄâÂûãÁ°Æ‰øù‰∫ÜÈ°πÁõÆÁöÑÂèØË°åÊÄßÂíåÂèØÂÆûÊñΩÊÄß„ÄÇ
Ôºà‰∏âÔºâÁ≥ªÁªüËÆæËÆ°
ËØ∑ÊèèËø∞Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÁöÑÊäÄÊúØÊû∂ÊûÑ„ÄÇ
ÈááÁî® B/SÔºàÊµèËßàÂô® / ÊúçÂä°Âô®ÔºâÁªìÊûÑÔºåÂâçÁ´Ø‰ΩøÁî® Vue.js ÂºÄÂèëÔºåÈÄöËøá Axios Âêë Spring Boot ÂêéÁ´ØÂèëÈÄÅ HTTP ËØ∑Ê±ÇÔºåÂêéÁ´Ø‰ª• RESTful API Êé•Âè£ÂΩ¢ÂºèÊèê‰æõÊúçÂä°ÔºåËÆøÈóÆ MySQL Êï∞ÊçÆÂ∫ìÔºåÂÆûÁé∞Á≥ªÁªüÁöÑÈ´òÂÜÖËÅö„ÄÅ‰ΩéËÄ¶Âêà„ÄÇ
Â±ÇÊ¨°ÁªìÊûÑ ÔºöÂâçÁ´ØÂ±ÇË¥üË¥£Áî®Êà∑‰∫§‰∫í‰∏éÁïåÈù¢Â±ïÁ§∫ÔºõÂêéÁ´ØÂ±ÇÂàÜ‰∏∫ÊéßÂà∂Âô®Â±Ç„ÄÅÊúçÂä°Â±Ç„ÄÅÊï∞ÊçÆËÆøÈóÆÂ±Ç„ÄÅÂÆû‰ΩìÂ±ÇÂíåÈÖçÁΩÆÂ±ÇÔºõÊï∞ÊçÆÂ∫ìÂ±ÇÁî®‰∫éÂ≠òÂÇ®Á≥ªÁªüÊï∞ÊçÆÔºåËÆæËÆ° 11 Âº†Ë°®ÔºåÈÄöËøáÂ§ñÈîÆÂÖ≥ËÅîÂÆûÁé∞Êï∞ÊçÆËÅîÂä®„ÄÇ
Áî®‰æãÂª∫Ê®° ÔºöÂõ¥ÁªïÂú®Á∫øÂÆûÊó∂ÁÆ°ÁêÜÂÜúÁî∞Ëøô‰∏Ä‰∏ªÈ¢òÔºåÂ∞ÜÁ≥ªÁªüÂäüËÉΩÂàíÂàÜ‰∏∫‰∫îÂ§ßÊ®°ÂùóÔºåÂàÜÂà´‰∏∫ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜ„ÄÇ‰∏çÂêåËßíËâ≤ÁôªÂΩïÂêéÔºåÂèØÊâßË°åÁõ∏Â∫îÊìç‰ΩúÔºåÂ¶ÇÁÆ°ÁêÜÂëòÂèØËøõË°åÁ≥ªÁªüÂÖ¨ÂëäÁÆ°ÁêÜ„ÄÅÂÜúÂú∫ÂëòÂ∑•ÁÆ°ÁêÜ„ÄÅËßíËâ≤ÊùÉÈôêÂàÜÈÖç„ÄÅËèúÂçïÈÖçÁΩÆÁ≠âÊìç‰ΩúÔºåÂÜúÂú∫ÂëòÂ∑•ÂèØÊü•ÁúãÂÜúÂú∫Á≥ªÁªüÂÖ¨Âëä„ÄÅÂÜúÂú∫ÁéØÂ¢ÉÁõëÊµãÁªìÊûúÂíåÂÜúÁî∞Âü∫Êú¨‰ø°ÊÅØÁ≠â„ÄÇ
Á≥ªÁªüËØ¶ÁªÜËÆæËÆ° ÔºöÊòéÁ°ÆÂêÑÁ±ªÁî®Êà∑ÔºàÂÜúÂú∫ÁÆ°ÁêÜÂëò„ÄÅÊôÆÈÄöÂëòÂ∑•ÔºâÁöÑÁôªÂΩïÂèäÊìç‰ΩúÊµÅÁ®ã„ÄÇÂÜúÂú∫ÁÆ°ÁêÜÂëòÂèØÊìç‰ΩúÁ≥ªÁªüÊâÄÊúâÊ®°ÂùóÔºåÂåÖÊã¨ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜÔºõÊôÆÈÄöÂëòÂ∑•ÁôªÂΩïÂêéÔºåÂèØÂØπÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜÁ≠âÊ®°ÂùóËøõË°åÁÆ°ÁêÜ„ÄÇ
ÔºàÂõõÔºâÁ≥ªÁªüÂÆûÁé∞
ÂâçÁ´ØÂºÄÂèë ÔºöÊäÄÊúØÊ†à‰∏∫ Vue.js + Vue Router + Vuex + Element UI + Axios„ÄÇÂÆûÁé∞ÂÖ≥ÈîÆÂäüËÉΩÂåÖÊã¨Âä®ÊÄÅË∑ØÁî±ÔºàÊ†πÊçÆÁî®Êà∑ËßíËâ≤Âä®ÊÄÅÂä†ËΩΩÂèØËÆøÈóÆÁöÑËèúÂçïË∑ØÁî±ÔºåÂÆûÁé∞ÊùÉÈôêÈöîÁ¶ªÔºâ„ÄÅÊï∞ÊçÆÂèØËßÜÂåñÔºà‰ΩøÁî® ECharts ÁªòÂà∂ÁéØÂ¢ÉÊï∞ÊçÆÊäòÁ∫øÂõæ„ÄÅÊü±Áä∂ÂõæÔºåÊîØÊåÅÊó∂Èó¥ËåÉÂõ¥Á≠õÈÄâÔºâ„ÄÅÊñá‰ª∂Êìç‰ΩúÔºàÈÄöËøá Element UI ÁöÑ Upload ÁªÑ‰ª∂ÂÆûÁé∞ Excel Êñá‰ª∂ÂØºÂÖ•ÔºåË∞ÉÁî® Blob ÂØπË±°ÂÆûÁé∞Êï∞ÊçÆÂØºÂá∫Ôºâ„ÄÇ
ÂêéÁ´ØÂºÄÂèë ÔºöÊäÄÊúØÊ†à‰∏∫ Spring Boot + MyBatis-Plus + MySQL + JWT + WebSocket„ÄÇÂÆûÁé∞ÂÖ≥ÈîÆÂäüËÉΩÂåÖÊã¨ÊùÉÈôêÁÆ°ÁêÜÔºàÈÄöËøá JwtInterceptor Êã¶Êà™Âô®È™åËØÅÁî®Êà∑ TokenÔºåÁªìÂêà RoleEnum Êûö‰∏æÁ±ªÂÆûÁé∞ËßíËâ≤ÊùÉÈôêÊéßÂà∂Ôºâ„ÄÅÊï∞ÊçÆÁªüËÆ°Ôºà‰ΩøÁî® MyBatis-Plus ÁöÑ Wrapper Ë°®ËææÂºèÂÆûÁé∞Â§çÊùÇÊü•ËØ¢ÔºåÂ¶ÇÊåâÊó∂Èó¥ÁªüËÆ°ÂÜúÁî∞ÁéØÂ¢ÉÊï∞ÊçÆÂπ≥ÂùáÂÄºÔºâ„ÄÅÂÆûÊó∂ÈÄö‰ø°ÔºàÈõÜÊàê WebSocket ÂÆûÁé∞ÂÆûÊó∂ÈÄöÁü•ÔºåÂ¶ÇÂ∫ìÂ≠òÈ¢ÑË≠¶„ÄÅÂÖ¨ÂëäÊé®ÈÄÅÁ≠âÊ∂àÊÅØÔºâ„ÄÇ
Ôºà‰∫îÔºâÈÉ®ÁΩ≤‰∏éËøêË°å
Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÁöÑÈÉ®ÁΩ≤ÁéØÂ¢ÉË¶ÅÊ±ÇÊòØ‰ªÄ‰πàÔºü
ÈúÄË¶Å JDK 1.8+„ÄÅNode.js 12+„ÄÅMySQL 5.7+„ÄÅMaven 3.6+„ÄÇ
Â¶Ç‰ΩïËøõË°åÂâçÁ´ØÂíåÂêéÁ´ØÁöÑÈÉ®ÁΩ≤Ôºü
ÂâçÁ´ØÈÉ®ÁΩ≤ÔºöÈÄöËøá git ÂÖãÈöÜÈ°πÁõÆÔºåËøõÂÖ•ÂâçÁ´ØÈ°πÁõÆÁõÆÂΩïÔºåÂÆâË£Ö‰æùËµñÔºå‰ΩøÁî® npm run serve ÂêØÂä®ÂºÄÂèëÊúçÂä°Âô®Êàñ npm run build ÊûÑÂª∫Áîü‰∫ßÁéØÂ¢É„ÄÇÂêéÁ´ØÈÉ®ÁΩ≤ÔºöËøõÂÖ•ÂêéÁ´ØÈ°πÁõÆÁõÆÂΩïÔºå‰ΩøÁî® Maven ÊûÑÂª∫È°πÁõÆÔºåÈÄöËøá java -jar target/smartfarm-0.0.1-SNAPSHOT.jar ËøêË°å JAR Êñá‰ª∂„ÄÇ
Á≥ªÁªüËøêË°åÊó∂Ôºå‰∏çÂêåËßíËâ≤Áî®Êà∑ÂàÜÂà´ËÉΩÁúãÂà∞Âì™‰∫õÂäüËÉΩÊ®°ÂùóÔºü
Áî®Êà∑ÁôªÂΩïÂêéÔºåÁÆ°ÁêÜÂëòÂèØÁÆ°ÁêÜÁ≥ªÁªüÊâÄÊúâÂäüËÉΩÔºåÂåÖÊã¨ÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜ„ÄÅÁ≥ªÁªüÁÆ°ÁêÜÔºõÊôÆÈÄöÂëòÂ∑•ÂèØÊü•ÁúãÂÜúÂú∫‰∏ªÈ°µÁ≥ªÁªüÂÖ¨ÂëäÈÄöÁü•„ÄÅÂÜúÂú∫ÁªüËÆ°ÂàÜÊûê„ÄÅÂÜúÁî∞ÁÆ°ÁêÜ„ÄÅÂÜú‰ΩúÁâ©ËµÑÁÆ°ÁêÜÁ≠âÊ®°ÂùóÔºåÂÖ∑‰ΩìÂäüËÉΩÂèñÂÜ≥‰∫éÂÖ∂ËßíËâ≤ÊùÉÈôê„ÄÇ
ÔºàÂÖ≠ÔºâÈ°πÁõÆÊàêÊûú‰∏éÊÄªÁªì
Êô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÂèñÂæó‰∫ÜÂì™‰∫õÊàêÊûúÔºü
ÊàêÂäüÊê≠Âª∫‰∫Ü‰∏Ä‰∏™ÈõÜÂÆûÊó∂ÁõëÊµã„ÄÅÊô∫ËÉΩÁÆ°ÁêÜÁ≠âÂäüËÉΩ‰∫é‰∏Ä‰ΩìÁöÑÊô∫ÊÖßÂÜúÁî∞ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÂÆûÁé∞‰∫ÜÂØπÂÜúÁî∞ÁöÑÂÖ®Êñπ‰ΩçÊô∫ËÉΩÂåñÁÆ°ÁêÜÔºåÊúâÊïàÊèêÈ´ò‰∫ÜÂÜú‰∏öÁîü‰∫ßÊïàÁéá„ÄÅËµÑÊ∫êÂà©Áî®Áéá‰ª•ÂèäÂÜú‰∫ßÂìÅË¥®ÈáèÂÆâÂÖ®ÔºåÊé®Âä®‰∫ÜÂÜú‰∏öÂèØÊåÅÁª≠ÂèëÂ±ï„ÄÇ
È°πÁõÆÁªÑÊàêÂëòÂú®È°πÁõÆ‰∏≠ÊúâÂì™‰∫õÊî∂Ëé∑ÂíåÊàêÈïøÔºü
È°πÁõÆÁªÑÊàêÂëòÂú®ÊäÄÊúØËÉΩÂäõ„ÄÅÂõ¢ÈòüÂçè‰Ωú‰∏éÁÆ°ÁêÜÁ≠âÊñπÈù¢ÂùáÂèñÂæó‰∫ÜÊòæËëóÊàêÈïø„ÄÇ‰æãÂ¶ÇÔºåËøûÈÄöÂú®ÊäÄÊúØ‰∏ä‰∏ªÂØºÂºÄÂèëÊ∫ØÊ∫êÁ†ÅÁîüÊàêÁ≥ªÁªüÔºåÊéåÊè°‰∫ÜÂâçÂêéÁ´ØÂºÄÂèëÊäÄËÉΩÔºåÂõ¢ÈòüÂçè‰Ωú‰∏ä‰Ωú‰∏∫ÁªÑÈïøÁªüÁ≠πËßÑÂàíÈ°πÁõÆÔºåÂêàÁêÜÂàÜÈÖç‰ªªÂä°ÔºåÊøÄÂèëÂõ¢ÈòüÊàêÂëòÁßØÊûÅÊÄßÔºõÊùéÊ∂µÂÆûÁé∞‰∫Ü‰ªéÂçïÁ∫ØÊäÄÊúØÂºÄÂèëÂà∞‰∏öÂä° + ÊäÄÊúØÂèåÈ©±Âä®ÁöÑÊÄùÁª¥ËΩ¨ÂèòÔºåÊéåÊè°‰∫ÜÂÜú‰∏öÁâ©ËÅîÁΩëÁ≥ªÁªüÂÖ®ÊµÅÁ®ãÂºÄÂèëÁªèÈ™åÔºõËåÉÈæôÈ£ûÁ≥ªÁªüÊéåÊè°‰∫Ü Spring Boot + Vue ÂÖ®Ê†àÂºÄÂèëÊäÄÊúØÊ†àÔºåÂú® JWT Èâ¥ÊùÉ„ÄÅMyBatis-Plus Âä®ÊÄÅ SQL„ÄÅECharts Êï∞ÊçÆÂèØËßÜÂåñÁ≠âÂÖ≥ÈîÆÊäÄÊúØ‰∏äÊúâÊòæËëóÊèêÂçáÔºõÂÆâÂè∂Á£äÂ≠¶‰π†‰∫ÜÂæÆ‰ø°Â∞èÁ®ãÂ∫èÂºÄÂèëÂÖ®ÊµÅÁ®ãÔºåÊéåÊè°‰∫Ü JavaScript Ê†∏ÂøÉÁâπÊÄßÔºåÂÆûË∑µ‰∫ÜÂâçÂêéÁ´ØÂàÜÁ¶ªÊû∂ÊûÑÁ≠â„ÄÇ
ÂØπÈ°πÁõÆÁöÑÊú™Êù•Â±ïÊúõÊòØ‰ªÄ‰πàÔºü
Êú™Êù•Â∞ÜËøõ‰∏ÄÊ≠•‰ºòÂåñÂíåÊãìÂ±ïÁ≥ªÁªüÂäüËÉΩÔºåÂ¶ÇÂú®ÁªüËÆ°ÂàÜÊûêÂäüËÉΩ‰∏äËøõË°å‰ºòÂåñ‰ª•Êèê‰æõÊõ¥Á≤æÂáÜÁöÑÂÜ≥Á≠ñÊîØÊåÅÔºåÈõÜÊàê AI ÊäÄÊúØÊèêÈ´òÁ≥ªÁªüÊô∫ËÉΩÂåñÊ∞¥Âπ≥ÔºåÂà©Áî®Âå∫ÂùóÈìæÊäÄÊúØÂª∫Á´ãÂÜú‰∫ßÂìÅÊ∫ØÊ∫êÁ≥ªÁªüÔºåÂºÄÂèëÁßªÂä®Á´ØÂ∫îÁî®Êñπ‰æøÂÜúÊ∞ëÈöèÊó∂ÈöèÂú∞ÁÆ°ÁêÜÂÜúÁî∞ÔºåÈõÜÊàêÊõ¥Â§öÁâ©ËÅîÁΩëËÆæÂ§áÂÆûÁé∞Êõ¥ÂÖ®Èù¢ÁöÑÂÜúÁî∞ÁõëÊµãÂíåÊéßÂà∂ÔºåÊèêÂçáÁ≥ªÁªüÁöÑÂ§ßÊï∞ÊçÆÂàÜÊûêËÉΩÂäõÁ≠âÔºåÊåÅÁª≠Êé®Âä®Êô∫ÊÖßÂÜú‰∏öÁöÑÂèëÂ±ï„ÄÇ
`;
                // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊ≥®ÂÖ•Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ
                if (state.shouldInjectDatabase && databaseContent) {
                    systemPrompt += `\n\n„ÄêÊúÄÊñ∞Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ„Äë\n${databaseContent}`;
                    state.shouldInjectDatabase = false; // ‰ΩøÁî®ÂêéÁ´ãÂç≥ÈáçÁΩÆÊ†áÂøó
                }

                if (knowledgeResults.length > 0) {
                    systemPrompt += '\n\n‰ª•‰∏ãÊòØÁõ∏ÂÖ≥ÁöÑÂÜú‰∏öÁü•ËØÜÔºö\n' + knowledgeResults.join('\n');
                }

                const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer sk-0ee13d616bf34ab6b73bedfd4fb3ad54',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: message }
                        ],
                        max_tokens: 1000
                    })
                });
                const data = await response.json();
                return data.choices[0].message.content;
            } catch (error) {
                console.error('DeepSeek API Error:', error);
                showNotification('AIÊúçÂä°ÊöÇÊó∂‰∏çÂèØÁî®', 'error');
                return 'Êä±Ê≠âÔºåAIÊúçÂä°ÊöÇÊó∂‰∏çÂèØÁî®ÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇÂ¶ÇÊûúÊÇ®ÊúâÂÜú‰∏öÁõ∏ÂÖ≥ÈóÆÈ¢òÔºåÊàë‰ºöÂ∞ΩÂäõ‰∏∫ÊÇ®Ëß£Á≠î„ÄÇ';
            }
        }

        // Emotional Analysis
        async function analyzeEmotion(message) {
            try {
                const response = await sendToDeepSeek(`ÂàÜÊûê‰ª•‰∏ãÊ∂àÊÅØÁöÑÊÉÖÊÑüÂÄæÂêëÔºåËøîÂõû"ÂºÄÂøÉ"„ÄÅ"Â•ΩÂ•á"Êàñ"ÊÇ≤‰º§"Ôºö${message}`);
                return response.toLowerCase().includes('ÂºÄÂøÉ') ? 'Happy' :
                       response.toLowerCase().includes('Â•ΩÂ•á') ? 'Curious' : 'Sad';
            } catch (error) {
                console.error('Emotion Analysis Error:', error);
                return 'Happy';
            }
        }

        // Email Service (Mocked)
        function sendEmail(to, subject, body) {
            showNotification(`Ê®°ÊãüÂèëÈÄÅÈÇÆ‰ª∂Ëá≥ ${to}: ${subject}`);
            return true;
        }

        // Speech Recognition
        function initSpeechRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (SpeechRecognition) {
                state.speechRecognition = new SpeechRecognition();
                state.speechRecognition.lang = 'zh-CN';
                state.speechRecognition.interimResults = true;
                state.speechRecognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('message-input').value = transcript;
                    if (event.results[0].isFinal) {
                        sendMessage(transcript);
                    }
                };
                state.speechRecognition.onend = () => {
                    state.isVoiceActive = false;
                    document.getElementById('voice-waves').classList.add('hidden');
                    document.getElementById('mic-icon').classList.remove('hidden');
                    updateStatusPanel();
                };
                state.speechRecognition.onerror = () => {
                    showNotification('ËØ≠Èü≥ËØÜÂà´Â§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');
                    state.isVoiceActive = false;
                    document.getElementById('voice-waves').classList.add('hidden');
                    document.getElementById('mic-icon').classList.remove('hidden');
                    updateStatusPanel();
                };
            } else {
                showNotification('ÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ËØÜÂà´', 'error');
            }
        }

        function toggleVoiceRecognition() {
            if (state.speechRecognition) {
                if (state.isVoiceActive) {
                    state.speechRecognition.stop();
                } else {
                    state.isVoiceActive = true;
                    document.getElementById('voice-waves').classList.remove('hidden');
                    document.getElementById('mic-icon').classList.add('hidden');
                    state.speechRecognition.start();
                    updateStatusPanel();
                }
            }
        }

        // Text-to-Speech
        function speak(text) {
            if (state.ttsEnabled) {
                // Ê∏ÖÁêÜÊñáÊú¨‰∏≠ÁöÑË°®ÊÉÖÁ¨¶Âè∑
                const cleanText = text.replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu, '');

                // ‰ΩøÁî®Web Speech API
                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.lang = 'zh-CN';

                // ÊîπËøõËØ≠Èü≥ÂèÇÊï∞
                utterance.rate = 1.0; // ËØ≠ÈÄü
                utterance.pitch = 1.1; // Èü≥Ë∞É
                utterance.volume = 1.0; // Èü≥Èáè

                // ÈÄâÊã©Êõ¥Ëá™ÁÑ∂ÁöÑÂ£∞Èü≥ÔºàÂ¶ÇÊûúÊúâÔºâ
                const voices = window.speechSynthesis.getVoices();
                const chineseVoices = voices.filter(voice => voice.lang.includes('zh'));
                if (chineseVoices.length > 0) {
                    // ‰ºòÂÖàÈÄâÊã©Â•≥Â£∞
                    const femaleVoice = chineseVoices.find(voice => voice.name.includes('Female') || voice.name.includes('Â•≥'));
                    utterance.voice = femaleVoice || chineseVoices[0];
                }

                // ËØ≠Èü≥‰∫ã‰ª∂
                utterance.onstart = () => {
                    state.isSpeaking = true;
                    // ËØ¥ËØùÊó∂Êí≠ÊîæËØ¥ËØùÂä®Áîª
                    if (state.animations['Talking']) {
                        playAnimation('Talking');
                    }
                };

                utterance.onend = () => {
                    state.isSpeaking = false;
                    // ËØ¥ËØùÁªìÊùüÂêéÊÅ¢Â§çÂà∞ÈªòËÆ§Áä∂ÊÄÅ
                    if (state.animations['Idle']) {
                        playAnimation('Idle');
                    }
                };

                window.speechSynthesis.speak(utterance);
            }
        }

        // ËØ≠Èü≥ÊöÇÂÅúÂäüËÉΩ
        let currentUtterance = null;

        function pauseSpeech() {
            if (window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
                state.isSpeaking = false;
                // ÊÅ¢Â§çÂà∞ÂæÖÊú∫Áä∂ÊÄÅ
                setState('Idle');
                showNotification('ËØ≠Èü≥Â∑≤ÊöÇÂÅú');
            }
        }

        // Chat Functionality
        async function sendMessage(message) {
            if (!message.trim()) return;

            // Áî®Êà∑ËæìÂÖ•Êó∂Ëß¶ÂèëË∑≥ËàûÁä∂ÊÄÅ
            setState('UserInput');

            // Save to chat history
            const timestamp = new Date().toLocaleString('zh-CN');
            state.chatHistory.push({ role: 'user', content: message, timestamp });
            localStorage.setItem('chatHistory', JSON.stringify(state.chatHistory));

            // Add user message
            const chatMessages = document.getElementById('chat-messages');
            const userBubble = document.createElement('div');
            userBubble.className = 'chat-bubble flex justify-end';
            userBubble.innerHTML = `
                <div class="glass-effect rounded-lg p-3 max-w-xs bg-green-500/80">
                    <p class="text-white text-sm">${message}</p>
                    <p class="text-white/70 text-xs mt-1">${timestamp}</p>
                </div>
            `;
            chatMessages.appendChild(userBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            state.chatCount++;
            updateStatusPanel();
            playSound('message');

            // Show typing indicator - ÊÄùËÄÉÊó∂ËøõÂÖ•Â•îË∑ëÁä∂ÊÄÅ
            setState('Thinking');
            const typingBubble = document.createElement('div');
            typingBubble.className = 'chat-bubble';
            typingBubble.innerHTML = `
                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white text-xs font-bold">üå±</span>
                    </div>
                    <div class="glass-effect rounded-lg p-3">
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(typingBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // Get AI response
            const startTime = performance.now();
            const response = await sendToDeepSeek(message);
            const endTime = performance.now();
            state.responseTime = (endTime - startTime) / 1000;

            // Remove typing indicator
            typingBubble.remove();

            // Analyze emotion
            const emotion = await analyzeEmotion(message);
            setState(emotion);

            // Ê†πÊçÆÊ∂àÊÅØÂÜÖÂÆπËß¶ÂèëÁâπÂÆöÂä®‰Ωú
            if (message.toLowerCase().includes('hello') || message.includes('‰Ω†Â•Ω')) {
                playAnimation('Wave');
            } else if (message.toLowerCase().includes('yes') || message.includes('ÊòØÁöÑ') || message.includes('ÂØπ')) {
                playAnimation('Yes');
            } else if (message.toLowerCase().includes('no') || message.includes('‰∏ç') || message.includes('Âê¶')) {
                playAnimation('No');
            } else if (message.toLowerCase().includes('thumbs up') || message.includes('ÁÇπËµû') || message.includes('Â•Ω')) {
                playAnimation('Thumbsup');
            } else if (message.toLowerCase().includes('punch') || message.includes('Êã≥Âáª') || message.includes('Êâì')) {
                playAnimation('Punch');
            } else if (message.toLowerCase().includes('walk') || message.includes('Ëµ∞')) {
                playAnimation('Walking');
            } else if (message.toLowerCase().includes('run') || message.includes('Ë∑ë')) {
                playAnimation('Running');
            } else if (message.toLowerCase().includes('sit') || message.includes('Âùê')) {
                playAnimation('Sitting');
            } else if (message.toLowerCase().includes('stand') || message.includes('Á´ô')) {
                playAnimation('Standing');
            }

            // ÂõûÂ§çÊó∂ËÆæÁΩÆÁä∂ÊÄÅ
            setState('Replying');

            // Add AI response
            const aiBubble = document.createElement('div');
            aiBubble.className = 'chat-bubble';
            aiBubble.innerHTML = `
                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white text-xs font-bold">üå±</span>
                    </div>
                    <div class="glass-effect rounded-lg p-3 max-w-xs">
                        <p class="text-white text-sm">${response}</p>
                        <p class="text-white/70 text-xs mt-1">${timestamp}</p>
                    </div>
                </div>
            `;
            chatMessages.appendChild(aiBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            state.chatHistory.push({ role: 'assistant', content: response, timestamp });
            localStorage.setItem('chatHistory', JSON.stringify(state.chatHistory));
            updateStatusPanel();

            // Speak response
            speak(response);

            // ÂõûÂ§çÂÆåÊØïÂêéËøõÂÖ•ÂæÖÊú∫Áä∂ÊÄÅ
            setTimeout(() => {
                setState('Idle');
            }, 2000); // 2ÁßíÂêéËøõÂÖ•ÂæÖÊú∫Áä∂ÊÄÅ

            // Trigger specific animations
            if (message.toLowerCase().includes('hello') || message.includes('‰Ω†Â•Ω')) {
                playAnimation('Wave');
            }
        }

        // Load Chat History
        function loadChatHistory() {
            const history = localStorage.getItem('chatHistory');
            if (history) {
                state.chatHistory = JSON.parse(history);
                const chatMessages = document.getElementById('chat-messages');
                state.chatHistory.forEach(msg => {
                    const bubble = document.createElement('div');
                    bubble.className = `chat-bubble ${msg.role === 'user' ? 'flex justify-end' : ''}`;
                    bubble.innerHTML = `
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
                                <span class="text-white text-xs font-bold">${msg.role === 'user' ? 'U' : 'üå±'}</span>
                            </div>
                            <div class="glass-effect rounded-lg p-3 max-w-xs ${msg.role === 'user' ? 'bg-green-500/80' : ''}">
                                <p class="text-white text-sm">${msg.content}</p>
                                <p class="text-white/70 text-xs mt-1">${msg.timestamp}</p>
                            </div>
                        </div>
                    `;
                    chatMessages.appendChild(bubble);
                });
                chatMessages.scrollTop = chatMessages.scrollHeight;
                state.chatCount = state.chatHistory.filter(msg => msg.role === 'user').length;
                updateStatusPanel();
            }
        }

        // Display History Modal
        function showHistoryModal() {
            const historyMessages = document.getElementById('history-messages');
            historyMessages.innerHTML = '';
            state.chatHistory.forEach((msg, idx) => {
                const bubble = document.createElement('div');
                bubble.className = `chat-bubble ${msg.role === 'user' ? 'flex justify-end' : ''}`;
                bubble.innerHTML = `
                    <div class="flex items-start gap-3">
                        <div class="w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
                            <span class="text-white text-xs font-bold">${msg.role === 'user' ? 'U' : 'üå±'}</span>
                        </div>
                        <div class="glass-effect rounded-lg p-3 max-w-xs ${msg.role === 'user' ? 'bg-green-500/80' : ''}">
                            <p class="text-white text-sm">${msg.content}</p>
                            <p class="text-white/70 text-xs mt-1">${msg.timestamp}</p>
                            <div class="flex gap-2 mt-2">
                                <button class="copy-btn bg-blue-400 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs" data-idx="${idx}">Â§çÂà∂</button>
                                <button class="resend-btn bg-green-400 hover:bg-green-600 text-white px-2 py-1 rounded text-xs" data-idx="${idx}">ÈáçÂèë</button>
                                <button class="delete-btn bg-red-400 hover:bg-red-600 text-white px-2 py-1 rounded text-xs" data-idx="${idx}">Âà†Èô§</button>
                            </div>
                        </div>
                    </div>
                `;
                historyMessages.appendChild(bubble);
            });
            // ÊåâÈíÆ‰∫ã‰ª∂
            historyMessages.querySelectorAll('.copy-btn').forEach(btn => {
                btn.onclick = function() {
                    const idx = this.getAttribute('data-idx');
                    navigator.clipboard.writeText(state.chatHistory[idx].content);
                    showNotification('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                };
            });
            historyMessages.querySelectorAll('.resend-btn').forEach(btn => {
                btn.onclick = function() {
                    const idx = this.getAttribute('data-idx');
                    sendMessage(state.chatHistory[idx].content);
                };
            });
            historyMessages.querySelectorAll('.delete-btn').forEach(btn => {
                btn.onclick = function() {
                    const idx = this.getAttribute('data-idx');
                    state.chatHistory.splice(idx, 1);
                    localStorage.setItem('chatHistory', JSON.stringify(state.chatHistory));
                    showHistoryModal();
                };
            });
            // Ê∏ÖÁ©∫ÂéÜÂè≤
            document.getElementById('clear-history').onclick = function() {
                if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÂéÜÂè≤ËÆ∞ÂΩïÂêóÔºü')) {
                    state.chatHistory = [];
                    localStorage.removeItem('chatHistory');
                    showHistoryModal();
                }
            };
            state.historyModalVisible = true;
            document.getElementById('history-modal').classList.remove('hidden');
        }

        // Update Role Display
        function updateRoleDisplay() {
            document.getElementById('app-title').textContent = `${state.roleName} - Êô∫ÊÖßÂÜúÂú∫Âä©Êâã`;
            document.getElementById('chat-header').textContent = `${state.roleName} - Êô∫ÊÖßÂÜúÂú∫Âä©Êâã`;
        }

        // Apply User Settings
        function applySettings() {
            document.body.className = `min-h-screen ${state.theme} overflow-hidden`;
            document.querySelector('.main-container').className = `main-container flex h-[calc(100vh-80px)] ${state.layout}-layout`;
            document.getElementById('layout-select').value = state.layout;
            document.getElementById('theme-select').value = state.theme;
            document.getElementById('animation-speed').value = state.animationSpeed;
            document.getElementById('tts-toggle').checked = state.ttsEnabled;
            document.getElementById('role-name').value = state.roleName;
            document.getElementById('model-select').value = state.currentModel;
            document.getElementById('mouse-follow').checked = state.mouseFollow;
            localStorage.setItem('settings', JSON.stringify({
                layout: state.layout,
                theme: state.theme,
                animationSpeed: state.animationSpeed,
                ttsEnabled: state.ttsEnabled,
                roleName: state.roleName,
                currentModel: state.currentModel,
                mouseFollow: state.mouseFollow
            }));
            updateRoleDisplay();
        }

        // Load User Settings
        function loadSettings() {
            const settings = localStorage.getItem('settings');
            if (settings) {
                const parsed = JSON.parse(settings);
                state.layout = parsed.layout || 'horizontal';
                state.theme = parsed.theme || 'gradient-bg';
                state.animationSpeed = parsed.animationSpeed || 1;
                state.ttsEnabled = parsed.ttsEnabled || false;
                state.roleName = parsed.roleName || 'Â∞èËâæ';
                state.currentModel = parsed.currentModel || 'xiaoai';
                state.mouseFollow = parsed.mouseFollow !== undefined ? parsed.mouseFollow : true;
            }
            applySettings();
        }

        // Chat Panel Width Adjustment
        function initDivider() {
            const divider = document.getElementById('divider');
            const chatPanel = document.getElementById('chat-panel');
            let isDragging = false;

            divider.addEventListener('mousedown', () => {
                isDragging = true;
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging && window.innerWidth > 768) {
                    const newWidth = window.innerWidth - e.clientX;
                    if (newWidth >= 200 && newWidth <= 600) {
                        chatPanel.style.width = `${newWidth}px`;
                    }
                }
            });

            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    localStorage.setItem('chatWidth', chatPanel.style.width);
                    isDragging = false;
                }
            });

            const savedWidth = localStorage.getItem('chatWidth');
            if (savedWidth) {
                chatPanel.style.width = savedWidth;
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Three.js
            const { loadModel } = initThreeJS();

            // Initialize Map
            initMap();

            // Initialize Speech Recognition
            initSpeechRecognition();

            // Initialize Divider
            initDivider();

            // Load Settings and Chat History
            loadSettings();
            loadChatHistory();

            // Hide loading screen
            setTimeout(() => {
                document.getElementById('loading').classList.add('hidden');
            }, 2000);

            // Navigation Buttons
            document.getElementById('location-btn').addEventListener('click', () => {
                getCurrentLocation();
            });

            // Map Toggle
            document.getElementById('map-toggle').addEventListener('click', () => {
                const mapOverlay = document.getElementById('map-overlay');
                state.mapVisible = !state.mapVisible;
                if (state.mapVisible) {
                    mapOverlay.classList.remove('hidden');
                    document.getElementById('map-toggle').innerHTML = `
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 001.414-1.414L9.707 9.293V6z" clip-rule="evenodd"></path>
                        </svg>
                    `;
                } else {
                    mapOverlay.classList.add('hidden');
                    document.getElementById('map-toggle').innerHTML = `
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 10.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z" clip-rule="evenodd"></path>
                        </svg>
                    `;
                }
            });

            document.getElementById('refresh-btn').addEventListener('click', async () => {
                const correctApiKey = "123666";

                const enteredKey = prompt("ËØ∑ËæìÂÖ•ËÆøÈóÆÂØÜÈí•‰ª•Âà∑Êñ∞Êï∞ÊçÆÂ∫ìÂÜÖÂÆπÔºö");

                if (!enteredKey || enteredKey.trim() !== correctApiKey) {
                    showNotification("‚ùå ÂØÜÈí•ÈîôËØØÔºåÊó†Ê≥ïÂà∑Êñ∞Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ", 'error');
                    return;
                }

                try {
                    const response = await fetch('/combined.txt');  // Á°Æ‰øùË∑ØÂæÑÊ≠£Á°Æ
                    const text = await response.text();

                    // Â∞ÜÊï∞ÊçÆÂ∫ìÂÜÖÂÆπ‰øùÂ≠òÂà∞ÂÖ®Â±ÄÂèòÈáèÊàñ state ‰∏≠
                    databaseContent = text;

                    // ËÆæÁΩÆÊ†áÂøóÔºåË°®Á§∫‰∏ã‰∏ÄÊ¨°Ë∞ÉÁî® sendToDeepSeek Â∫îËØ•Ê≥®ÂÖ•Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ
                    state.shouldInjectDatabase = true;

                    showNotification("‚úÖ Êï∞ÊçÆÂ∫ìÂÜÖÂÆπÂ∑≤Âà∑Êñ∞Âπ∂Â∞ÜÂú®‰∏ãÊ¨°ÂØπËØù‰∏≠Ê≥®ÂÖ•");
                } catch (error) {
                    console.error('Êï∞ÊçÆÂ∫ìÂà∑Êñ∞Â§±Ë¥•:', error);
                    showNotification("‚ùå Âà∑Êñ∞Êï∞ÊçÆÂ∫ìÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂Ë∑ØÂæÑÊàñÁΩëÁªú", 'error');
                }
            });




            // Close Map
            document.getElementById('close-map').addEventListener('click', () => {
                document.getElementById('map-overlay').classList.add('hidden');
                state.mapVisible = false;
                document.getElementById('map-toggle').innerHTML = `
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 10.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z" clip-rule="evenodd"></path>
                    </svg>
                `;
            });

            // Services Button
            document.getElementById('services-btn').addEventListener('click', () => {
                state.servicesModalVisible = !state.servicesModalVisible;
                document.getElementById('services-modal').classList.toggle('hidden');
            });

            // Close Services Modal
            document.getElementById('close-services').addEventListener('click', () => {
                state.servicesModalVisible = false;
                document.getElementById('services-modal').classList.add('hidden');
            });

            // Service Buttons
            document.querySelectorAll('.service-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const service = btn.getAttribute('data-service');
                    switch (service) {
                        case 'ai-chat':
                            if (!state.servicesModalVisible) {
                                state.servicesModalVisible = true;
                                document.getElementById('services-modal').classList.remove('hidden');
                            } else {
                                document.getElementById('services-modal').classList.add('hidden');
                                state.servicesModalVisible = false;
                            }
                            break;
                        case 'navigation':
                            document.getElementById('map-overlay').classList.remove('hidden');
                            state.mapVisible = true;
                            document.getElementById('map-toggle').innerHTML = `
                                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 001.414-1.414L9.707 9.293V6z" clip-rule="evenodd"></path>
                                </svg>
                            `;
                            break;
                        case 'email':
                            const to = prompt('ËØ∑ËæìÂÖ•Êî∂‰ª∂‰∫∫ÈÇÆÁÆ±:');
                            if (to) {
                                const subject = prompt('ËØ∑ËæìÂÖ•ÈÇÆ‰ª∂‰∏ªÈ¢ò:');
                                if (subject) {
                                    const body = prompt('ËØ∑ËæìÂÖ•ÈÇÆ‰ª∂ÂÜÖÂÆπ:');
                                    if (body) {
                                        sendEmail(to, subject, body);
                                        showNotification('ÈÇÆ‰ª∂Â∑≤ÂèëÈÄÅ');
                                    }
                                }
                            }
                            break;
                        case 'settings':
                            state.settingsModalVisible = true;
                            document.getElementById('settings-modal').classList.remove('hidden');
                            break;
                        case 'system-status':
                            showNotification('Á≥ªÁªüÁä∂ÊÄÅÊ≠£Â∏∏ÔºåÊâÄÊúâÊúçÂä°ËøêË°åÊ≠£Â∏∏');
                            break;
                    }
                });
            });

            // Close Settings Modal
            document.getElementById('close-settings').addEventListener('click', () => {
                state.settingsModalVisible = false;
                document.getElementById('settings-modal').classList.add('hidden');
            });

            // Save Settings
            document.getElementById('save-settings').addEventListener('click', () => {
                state.layout = document.getElementById('layout-select').value;
                state.theme = document.getElementById('theme-select').value;
                state.animationSpeed = parseFloat(document.getElementById('animation-speed').value);
                state.ttsEnabled = document.getElementById('tts-toggle').checked;
                state.roleName = document.getElementById('role-name').value;
                state.currentModel = document.getElementById('model-select').value;
                state.mouseFollow = document.getElementById('mouse-follow').checked;
                applySettings();
                showNotification('ËÆæÁΩÆÂ∑≤‰øùÂ≠ò');
                loadModel(state.currentModel);
                state.settingsModalVisible = false;
                document.getElementById('settings-modal').classList.add('hidden');
            });

            // Quick Actions
            document.querySelectorAll('.quick-action').forEach(btn => {
                btn.addEventListener('click', () => {
                    const action = btn.getAttribute('data-action');
                    switch (action) {
                        case 'navigation':
                            document.getElementById('map-overlay').classList.remove('hidden');
                            state.mapVisible = true;
                            document.getElementById('map-toggle').innerHTML = `
                                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 001.414-1.414L9.707 9.293V6z" clip-rule="evenodd"></path>
                                </svg>
                            `;
                            break;
                        case 'weather':
                            if (state.currentPosition) {
                                getWeather(state.currentPosition.lat, state.currentPosition.lng);
                            } else {
                                showNotification('ËØ∑ÂÖàËé∑Âèñ‰ΩçÁΩÆ‰ø°ÊÅØ', 'error');
                            }
                            break;
                        case 'email':
                            const to = prompt('ËØ∑ËæìÂÖ•Êî∂‰ª∂‰∫∫ÈÇÆÁÆ±:');
                            if (to) {
                                const subject = prompt('ËØ∑ËæìÂÖ•ÈÇÆ‰ª∂‰∏ªÈ¢ò:');
                                if (subject) {
                                    const body = prompt('ËØ∑ËæìÂÖ•ÈÇÆ‰ª∂ÂÜÖÂÆπ:');
                                    if (body) {
                                        sendEmail(to, subject, body);
                                        showNotification('ÈÇÆ‰ª∂Â∑≤ÂèëÈÄÅ');
                                    }
                                }
                            }
                            break;
                        case 'settings':
                            state.settingsModalVisible = true;
                            document.getElementById('settings-modal').classList.remove('hidden');
                            break;
                        case 'history':
                            state.historyModalVisible = true;
                            showHistoryModal();
                            break;
                    }
                });
            });

            // Close History Modal
            document.getElementById('close-history').addEventListener('click', () => {
                state.historyModalVisible = false;
                document.getElementById('history-modal').classList.add('hidden');
            });

            // Send Message
            document.getElementById('send-btn').addEventListener('click', () => {
                const message = document.getElementById('message-input').value;
                sendMessage(message);
                document.getElementById('message-input').value = '';
            });

            document.getElementById('message-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const message = document.getElementById('message-input').value;
                    sendMessage(message);
                    document.getElementById('message-input').value = '';
                }
            });

            // Voice Recognition
            document.getElementById('voice-btn').addEventListener('click', () => {
                toggleVoiceRecognition();
            });

            // Êõ¥Êñ∞Âè≥ÈîÆËèúÂçï
            const contextMenu = document.getElementById('context-menu');
            contextMenu.innerHTML = `
                <a href="#" data-action="wave">Êå•ÊâãÂä®Áîª</a>
                <a href="#" data-action="idle">ÂæÖÊú∫Âä®Áîª</a>
                <a href="#" data-action="dance">Ë∑≥ËàûÂä®Áîª</a>
                <a href="#" data-action="walking">Ë°åËµ∞Âä®Áîª</a>
                <a href="#" data-action="running">Ë∑ëÊ≠•Âä®Áîª</a>
                <a href="#" data-action="sitting">Âùê‰∏ãÂä®Áîª</a>
                <a href="#" data-action="standing">Á´ôÁ´ãÂä®Áîª</a>
                <a href="#" data-action="yes">ÁÇπÂ§¥Âä®‰Ωú</a>
                <a href="#" data-action="no">ÊëáÂ§¥Âä®‰Ωú</a>
                <a href="#" data-action="punch">Êã≥ÂáªÂä®‰Ωú</a>
                <a href="#" data-action="thumbsup">ÁÇπËµûÂä®‰Ωú</a>
                <a href="#" data-action="happy">ÂºÄÂøÉË°®ÊÉÖ</a>
                <a href="#" data-action="sad">ÊÇ≤‰º§Ë°®ÊÉÖ</a>
                <a href="#" data-action="angry">ÁîüÊ∞îË°®ÊÉÖ</a>
                <a href="#" data-action="surprised">ÊÉäËÆ∂Ë°®ÊÉÖ</a>
                <a href="#" data-action="neutral">‰∏≠ÊÄßË°®ÊÉÖ</a>
                <a href="#" data-action="reset">ÈáçÁΩÆËßÜËßí</a>
            `;

            // Âè≥ÈîÆËèúÂçï‰∫ã‰ª∂
            document.querySelectorAll('#context-menu a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const action = link.getAttribute('data-action');

                    // Â§ÑÁêÜË°®ÊÉÖ
                    if (state.availableExpressions.includes(action)) {
                        setExpression(action);
                    }
                    // Â§ÑÁêÜÂä®ÁîªÂíåÂä®‰Ωú
                    else if (state.availableStates.includes(action) ||
                             state.availableEmotes.includes(action) ||
                             ['wave', 'idle', 'dance'].includes(action)) {
                        // È¶ñÂ≠óÊØçÂ§ßÂÜô
                        const animName = action.charAt(0).toUpperCase() + action.slice(1);
                        playAnimation(animName);
                    }
                    // ÈáçÁΩÆËßÜËßí
                    else if (action === 'reset') {
                        resetCamera();
                    }

                    document.getElementById('context-menu').style.display = 'none';
                });
            });

            // Map Search
            document.getElementById('poi-search').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const keyword = document.getElementById('poi-search').value;
                    searchPOI(keyword);
                }
            });

            // Navigation Actions
            document.querySelectorAll('.nav-dropdown a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const action = link.getAttribute('data-action');
                    switch (action) {
                        case 'current-location':
                            getCurrentLocation();
                            break;
                        case 'search-poi':
                            const keyword = prompt('ËØ∑ËæìÂÖ•Ë¶ÅÊêúÁ¥¢ÁöÑÂú∞ÁÇπ:');
                            if (keyword) {
                                searchPOI(keyword);
                            }
                            break;
                        case 'route-plan':
                            const destination = prompt('ËØ∑ËæìÂÖ•ÁõÆÁöÑÂú∞:');
                            if (destination && state.currentPosition) {
                                planRoute(destination);
                            } else {
                                showNotification('ËØ∑ÂÖàËé∑ÂèñÂΩìÂâç‰ΩçÁΩÆÊàñËæìÂÖ•ÊúâÊïàÁõÆÁöÑÂú∞', 'error');
                            }
                            break;
                    }
                });
            });

            // Set Initial Status
            updateStatusPanel();
        });

        // ÂèëÈÄÅÂª∫ËÆÆÊåâÈíÆ‰∫ã‰ª∂
        if (document.getElementById('send-suggestion')) {
            document.getElementById('send-suggestion').addEventListener('click', () => {
                const content = prompt('ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÂª∫ËÆÆÔºö');
                if (content) sendSuggestion(content);
            });
        }
        if (document.getElementById('service-suggestion-btn')) {
            document.getElementById('service-suggestion-btn').addEventListener('click', () => {
                const content = prompt('ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÂª∫ËÆÆÔºö');
                if (content) sendSuggestion(content);
            });
        }

        // ÈÇÆ‰ª∂ÊúçÂä°Êîπ‰∏∫ÂèëÈÄÅÂª∫ËÆÆ
        function sendSuggestion(content) {
            window.open('mailto:2138277532@qq.com?subject=Âª∫ËÆÆÂèçÈ¶à&body=' + encodeURIComponent(content));
            showNotification('Â∑≤ÊâìÂºÄÈÇÆ‰ª∂ÂÆ¢Êà∑Á´ØÔºåËØ∑ÂèëÈÄÅÊÇ®ÁöÑÂª∫ËÆÆ');
        }
    </script>
</body>
</html>